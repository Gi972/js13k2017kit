<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Game Zero ES6</title><style>
body{margin:0;overflow:hidden;background:#111;color:#ccc}#canvas{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%;image-rendering:optimizeSpeed;image-rendering:-moz-crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:-o-crisp-edges;image-rendering:pixelated;-ms-interpolation-mode:nearest-neighbor;cursor:none;margin:auto}
</style></head><body><canvas id="canvas"></canvas><script>
var GAME=function(){function t(e,t){var n=e,r=[];this.init=function(){for(var e=0;n>e;e++){var i=new t;i.init(),r[e]=i}},this.get=function(e){if(!r[n-1].inUse)return r[n-1].spawn(e),r.unshift(r.pop()),r[n-1]},this.getPool=function(){return r},this.use=function(){for(var e=0;n>e&&r[e].inUse;e++)r[e].use(g.dt)&&(r[e].clear(),r.push(r.splice(e,1)[0]))}}function n(){this.inUse=!1,this.init=function(){this.x=-500,this.y=-500,this.dead=!0,this.xvel=0,this.yvel=1,this.life=1},n.prototype.spawn=function(e){this.x=e.x,this.y=e.y,this.xvel=e.xvel,this.yvel=e.yvel,this.inUse=!0,this.life=e.life||1,this.remaining=e.life||1,this.radius=e.radius||1,this.color=e.color||g.WHITE,this.dead=!1},n.prototype.use=function(e){return!!this.dead||(this.remaining-=g.dt,this.x+=g.dt*this.xvel,this.y+=g.dt*this.yvel,this.remaining>0?(0>this.y&&(this.dead=!0),!1):(this.dead=!0,!0))},n.prototype.clear=function(){this.x=-500,this.y=-500,this.dead=!0,this.xvel=0,this.yvel=0,this.life=1,this.inUse=!1}}function r(e){return Math.sin(6.283184*e)}function i(e){return 0>r(e)?-1:1}function o(e){return e%1-.5}function a(e){var t=e%1*4;return 2>t?t-1:3-t}function s(e){return.00390625*Math.pow(1.059463094,e-128)}function l(e,t){setTimeout(function(){var n=new Uint8Array(e*d*2),r=n.length-2,i=function(){for(var e=new Date,o=0;r>=0;)if(n[r]=0,n[r+1]=128,r-=2,(o+=1)%1e3==0&&new Date-e>y)return void setTimeout(i,0);setTimeout(function(){t(n)},0)};setTimeout(i,0)},0)}function c(e,t,n,r,i){var o=n.fx_delay_time*r>>1,a=n.fx_delay_amt/255,s=0,l=function(){for(var n=new Date,r=0;t-o>s;){var c=4*s,u=4*(s+o),f=e[u]+(e[u+1]<<8)+(e[c+2]+(e[c+3]<<8)-32768)*a;if(e[u]=255&f,e[u+1]=f>>8&255,f=e[u+2]+(e[u+3]<<8)+(e[c]+(e[c+1]<<8)-32768)*a,e[u+2]=255&f,e[u+3]=f>>8&255,++s,(r+=1)%1e3==0&&new Date-n>y)return void setTimeout(l,0)}setTimeout(i,0)};setTimeout(l,0)}var u={};ENGINE={E:this,screen:0,page1:65536,page2:131072,page3:196608,page4:262144,page5:327680,page6:393216,page7:458752,Black:0,Valhalla:1,LouLou:2,OiledCedar:3,Rope:4,TahitiGold:5,Twine:6,Pancho:7,GoldenFizz:8,Atlantis:9,Christi:10,ElfGreen:11,Dell:12,Verdigris:13,Opal:14,DeepKoamaru:15,VeniceBlue:16,RoyalBlue:17,Cornflower:18,Viking:19,LightSteelBlue:20,White:21,Heather:22,Topaz:23,DimGray:24,SmokeyAsh:25,Clairvoyant:26,Red:27,Mandy:28,PinkPlum:29,RainForest:30,Stinger:31,colors:[4278190080,4281606178,4282132549,4281416038,4282078863,4280709599,4284915929,4288332782,4281791227,4283491737,4281384554,4285436983,4281297227,4280568658,4281941042,4285808447,4286734384,4292963931,4294941539,4293184863,4294761419,4294967295,4290227611,4287069828,4285164137,4283586137,4287251062,4281479852,4284700633,4290411479,4283078543,4281364362],palDefault:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],pal:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],renderTarget:0,renderSource:65536,currentState:0,playSound:function(e,t,n,r){var i=p.createBufferSource(),o=p.createGain(),a=p.createStereoPanner();return i.buffer=e,i.connect(a),a.connect(o),o.connect(p.destination),i.playbackRate.value=t,i.loop=r,o.gain.value=1,a.pan.value=n,i.start(),{volume:o,sound:i}},gfx:{clear:function(e){g.ram.fill(e,g.renderTarget,g.renderTarget+65536)},pset:function(e,t,n){t|=0,(e|=0)>-1&&256>e&&t>-1&&256>t&&(g.ram[g.renderTarget+(256*t+e)]=n)},line:function(e,t,n,r,i){var o,a,s=(r|=0)-(t|=0),l=(n|=0)-(e|=0);if(0>s?(s=-s,a=-1):a=1,0>l?(l=-l,o=-1):o=1,s<<=1,l<<=1,this.pset(e,t,i),l>s)for(var c=s-(l>>1);e!=n;)0>c||(t+=a,c-=l),e+=o,c+=s,this.pset(e,t,i);else for(c=l-(s>>1);t!=r;)0>c||(e+=o,c-=s),t+=a,c+=l,this.pset(e,t,i)},circle:function(e,t,n,r){var i=-n,o=0,a=2-2*n;do{this.pset(e-i,t+o,r),this.pset(e-o,t-i,r),this.pset(e+i,t-o,r),this.pset(e+o,t+i,r),(n=a)>o||(a+=2*++o+1),(n>i||a>o)&&(a+=2*++i+1)}while(0>i)},fillCircle:function(e,t,n,r){e|=0,t|=0,r|=0;var i=-(n|=0),o=0,a=2-2*n;do{this.line(e-i,t-o,e+i,t-o,r),this.line(e-i,t+o,e+i,t+o,r),(n=a)>o||(a+=2*++o+1),(n>i||a>o)&&(a+=2*++i+1)}while(0>i)},rect:function(e,t,n,r,i){e|=0,n|=0,t|=0,r|=0,this.line(e,t,n,t,i),this.line(n,t,n,r,i),this.line(e,r,n,r,i),this.line(e,t,e,r,i)},fillRect:function(e,t,n,r,i){e|=0,n|=0,t|=0,r|=0;var o=Math.abs(r-t);if(g.gfx.line(e,t,n,t,i),o>0)for(;--o;)g.gfx.line(e,t+o,n,t+o,i);g.gfx.line(e,r,n,r,i)},triangle:function(e,t,n,r,i,o,a){g.gfx.line(e,t,n,r,a),g.gfx.line(n,r,i,o,a),g.gfx.line(i,o,e,t,a)},fillTriangle:function(e,t,n,r,i,o,a){var e=Math.round(16*e),n=Math.round(16*n),i=Math.round(16*i),t=Math.round(16*t),s=e-n,l=(r=Math.round(16*r))-t,c=n-i,u=(o=Math.round(16*o))-r,f=i-e,h=t-o,d=Math.max(Math.min(e,n,i)+15>>4,0),y=Math.min(Math.max(e,n,i)+15>>4,256),p=Math.max(Math.min(t,r,o)+15>>4,0),v=Math.min(Math.max(t,r,o)+15>>4,256);d&=-8,p&=-8;var x=-l*e-s*t,m=-u*n-c*r,w=-h*i-f*o;(l>0||0==l&&s>0)&&x++,(u>0||0==u&&c>0)&&m++,(h>0||0==h&&f>0)&&w++,x=x-1>>4,m=m-1>>4,w=w-1>>4;var _=0,S=0,A=0,C=0,T=0,b=0;0>s?_-=7*s:S-=7*s,0>l?_-=7*l:S-=7*l,0>c?A-=7*c:C-=7*c,0>u?A-=7*u:C-=7*u,0>f?T-=7*f:b-=7*f,0>h?T-=7*h:b-=7*h;for(var D=p;v>D;D+=8)for(var E=d;y>E;E+=8){var M=x+s*D+l*E,R=m+c*D+u*E,I=w+f*D+h*E;if(!(S>M||C>R||b>I)){var G=E+256*D;if(M<_||R<A||I<T)for(K=0;8>K;K++){for(var P=M,N=R,k=I,L=0;8>L;L++)0>(P|N|k)||(g.ram[g.renderTarget+G]=a),P+=l,N+=u,k+=h,G++;M+=s,R+=c,I+=f,G+=248}else for(var K=0;8>K;K++){for(L=0;8>L;L++,G++)g.ram[g.renderTarget+G]=a;G+=248}}}},spr:function(e=0,t=0,n=16,r=16,i=0,o=0,a=!1,s=!1){for(var l=0;r>l;l++)for(var c=0;n>c;c++)255>o+l&&255>i+c&&o+l>-1&&i+c>-1&&(a&s?g.ram[g.renderSource+(256*(t+(r-l))+e+(n-c))]>0&&(g.ram[g.renderTarget+(256*(o+l)+i+c)]=g.pal[g.ram[g.renderSource+(256*(t+(r-l))+e+(n-c))]]):s&&!a?g.ram[g.renderSource+(256*(t+(r-l))+e+c)]>0&&(g.ram[g.renderTarget+(256*(o+l)+i+c)]=g.ram[g.renderSource+(256*(t+(r-l))+e+c)]):a&&!s?g.ram[g.renderSource+(256*(t+l)+e+(n-c))]>0&&(g.ram[g.renderTarget+(256*(o+l)+i+c)]=g.ram[g.renderSource+(256*(t+l)+e+(n-c))]):a||s||g.ram[g.renderSource+(256*(t+l)+e+c)]>0&&(g.ram[g.renderTarget+(256*(o+l)+i+c)]=g.pal[g.ram[g.renderSource+(256*(t+l)+e+c)]]))},sspr:function(e=0,t=0,n=16,r=16,i=0,o=0,a=16,s=16,l=!1,c=!1){for(var u=n/a,f=r/s,h=0;s>h;h++)for(var d=0;a>d;d++)px=d*u|0,py=h*f|0,255>o+h&&255>i+d&&o+h>-1&&i+d>-1&&g.ram[g.renderSource+(256*(t+py)+e+px)]>0&&(g.ram[g.renderTarget+(256*(o+h)+i+d)]=g.ram[g.renderSource+(256*(t+py)+e+px)])},rspr:function(e,t,n,r,i,o,a,s){s*=.0174533;var l=e+n/2,c=t+r/2,u=n*a,f=r*a,h=u/2,d=f/2,y=i-h,p=i+h,v=o-d,x=o+d,m=Math.cos(-s),w=Math.sin(-s),_=1/a,S=i-l,A=o-c;for(let e=v;x>e;e++)for(let t=y;p>t;t++){let n=(m*t*_+w*e*_|0)+S,r=(-w*t*_+m*e*_|0)+A;g.ram[g.renderTarget+(256*e+t)]=0>n||0>r||n>u||r>f?0:g.ram[g.renderSource+(256*r+n)]}},checker:function(e,t,n){var r=256,i=256,o=0,a=0;e=e||8,r/=t=t||8,i/=e;for(var s=0;e>s;++s)for(var l=0,c=t/2;c>l;++l)o=2*l*r+(s%2?0:r),a=s*i,g.gfx.fillRect(o,a,o+r-1,a+i-1,n)}},util:{toPolarScreen:function(e){let t=1.40625*e.x*.0174533,n=e.y/2;return g.util.polarToPoint(t,n)},norm:function(e,t,n){return(e-t)/(n-t)},dist:function(e,t,n,r){if(2===arguments.length)return this.dist(e.x,e.y,t.x,t.y);var i=n-e,o=r-t;return Math.sqrt(i*i+o*o)},polarToPoint:function(e,t){return{x:Math.cos(e)*t,y:Math.sin(e)*t}},pointToPolar:function(e){return{angle:Math.atan2(e.y,e.x),radius:this.magnitude(e)}},magnitude:function(e){return this.dist(0,0,e.x,e.y)},scale:function(e){}},canvasInit:function(){g.canvas=document.getElementById("canvas"),g.ctx=canvas.getContext("2d"),g.canvas.width=window.innerWidth,g.canvas.height=window.innerHeight,g.ctx.imageSmoothingEnabled=!1,g.ctx.mozImageSmoothingEnabled=!1,g.smallcanvas=document.createElement("canvas"),g.smallctx=g.smallcanvas.getContext("2d"),g.smallcanvas.width=256,g.smallcanvas.height=256,g.canvasHeight=g.smallcanvas.height,g.canvasWidth=g.smallcanvas.width,g.imageData=g.smallctx.getImageData(0,0,g.canvasWidth,g.canvasHeight),g.buf=new ArrayBuffer(g.imageData.data.length),g.buf8=new Uint8ClampedArray(g.buf),g.data=new Uint32Array(g.buf),g.ram=new Uint8ClampedArray(524288),g.renderTarget=g.screen},render:function(){for(var e=65536;e--;)g.data[e]=g.colors[g.pal[g.ram[e]]];g.imageData.data.set(g.buf8),g.smallctx.putImageData(g.imageData,0,0),g.compositeSize=window.innerWidth<window.innerHeight?window.innerWidth:window.innerHeight,g.compositeOrigin=(window.innerWidth-g.compositeSize)/2|0,g.ctx.imageSmoothingEnabled=!1,g.ctx.mozImageSmoothingEnabled=!1,g.ctx.drawImage(g.smallcanvas,0,0,255,255,g.compositeOrigin,0,g.compositeSize,g.compositeSize)}};g=ENGINE;Number.prototype.map=function(e,t,n,r){return(this-e)*(r-n)/(t-e)+n};var f={VERSION:"2.3.5",Result:{SUCCEEDED:1,NOTRANSITION:2,CANCELLED:3,PENDING:4},Error:{INVALID_TRANSITION:100,PENDING_TRANSITION:200,INVALID_CALLBACK:300},WILDCARD:"*",ASYNC:"async",create:function(e,t){var n="string"==typeof e.initial?{state:e.initial}:e.initial,r=e.terminal||e.final,i=t||e.target||{},o=e.events||[],a=e.callbacks||{},s={},l={},c=function(e){var t=e.from instanceof Array?e.from:e.from?[e.from]:[f.WILDCARD];s[e.name]=s[e.name]||{};for(var n=0;n<t.length;n++)l[t[n]]=l[t[n]]||[],l[t[n]].push(e.name),s[e.name][t[n]]=e.to||t[n]};n&&(n.event=n.event||"startup",c({name:n.event,from:"none",to:n.state}));for(var u=0;o.length>u;u++)c(o[u]);for(var h in s)s.hasOwnProperty(h)&&(i[h]=f.buildEvent(h,s[h]));for(var h in a)a.hasOwnProperty(h)&&(i[h]=a[h]);return i.current="none",i.is=function(e){return e instanceof Array?e.indexOf(this.current)>=0:this.current===e},i.can=function(e){return!this.transition&&(s[e].hasOwnProperty(this.current)||s[e].hasOwnProperty(f.WILDCARD))},i.cannot=function(e){return!this.can(e)},i.transitions=function(){return l[this.current]},i.isFinished=function(){return this.is(r)},i.error=e.error||function(e,t,n,r,i,o,a){throw a||o},n&&!n.defer&&i[n.event](),i},doCallback:function(e,t,n,r,i,o){if(t)try{return t.apply(e,[n,r,i].concat(o))}catch(t){return e.error(n,r,i,o,f.Error.INVALID_CALLBACK,"an exception occurred in a caller-provided callback function",t)}},beforeAnyEvent:function(e,t,n,r,i){return f.doCallback(e,e.onbeforeevent,t,n,r,i)},afterAnyEvent:function(e,t,n,r,i){return f.doCallback(e,e.onafterevent||e.onevent,t,n,r,i)},leaveAnyState:function(e,t,n,r,i){return f.doCallback(e,e.onleavestate,t,n,r,i)},enterAnyState:function(e,t,n,r,i){return f.doCallback(e,e.onenterstate||e.onstate,t,n,r,i)},changeState:function(e,t,n,r,i){return f.doCallback(e,e.onchangestate,t,n,r,i)},beforeThisEvent:function(e,t,n,r,i){return f.doCallback(e,e["onbefore"+t],t,n,r,i)},afterThisEvent:function(e,t,n,r,i){return f.doCallback(e,e["onafter"+t]||e["on"+t],t,n,r,i)},leaveThisState:function(e,t,n,r,i){return f.doCallback(e,e["onleave"+n],t,n,r,i)},enterThisState:function(e,t,n,r,i){return f.doCallback(e,e["onenter"+r]||e["on"+r],t,n,r,i)},beforeEvent:function(e,t,n,r,i){if(!1===f.beforeThisEvent(e,t,n,r,i)||!1===f.beforeAnyEvent(e,t,n,r,i))return!1},afterEvent:function(e,t,n,r,i){f.afterThisEvent(e,t,n,r,i),f.afterAnyEvent(e,t,n,r,i)},leaveState:function(e,t,n,r,i){var o=f.leaveThisState(e,t,n,r,i),a=f.leaveAnyState(e,t,n,r,i);return!1!==o&&!1!==a&&(f.ASYNC===o||f.ASYNC===a?f.ASYNC:void 0)},enterState:function(e,t,n,r,i){f.enterThisState(e,t,n,r,i),f.enterAnyState(e,t,n,r,i)},buildEvent:function(e,t){return function(){var n=this.current,r=t[n]||t[f.WILDCARD]||n,i=Array.prototype.slice.call(arguments);if(this.transition)return this.error(e,n,r,i,f.Error.PENDING_TRANSITION,"event "+e+" inappropriate because previous transition did not complete");if(this.cannot(e))return this.error(e,n,r,i,f.Error.INVALID_TRANSITION,"event "+e+" inappropriate in current state "+this.current);if(!1===f.beforeEvent(this,e,n,r,i))return f.Result.CANCELLED;if(n===r)return f.afterEvent(this,e,n,r,i),f.Result.NOTRANSITION;var o=this;this.transition=function(){return o.transition=null,o.current=r,f.enterState(o,e,n,r,i),f.changeState(o,e,n,r,i),f.afterEvent(o,e,n,r,i),f.Result.SUCCEEDED},this.transition.cancel=function(){o.transition=null,f.afterEvent(o,e,n,r,i)};var a=f.leaveState(this,e,n,r,i);return!1===a?(this.transition=null,f.Result.CANCELLED):f.ASYNC===a?f.Result.PENDING:this.transition?this.transition():void 0}}};g.assets={sounds:{laserOne:{osc1_oct:6,osc1_det:0,osc1_detune:0,osc1_xenv:1,osc1_vol:192,osc1_waveform:3,osc2_oct:8,osc2_det:0,osc2_detune:0,osc2_xenv:1,osc2_vol:192,osc2_waveform:1,noise_fader:0,env_attack:0,env_sustain:0,env_release:7916,env_master:99,fx_filter:0,fx_freq:11025,fx_resonance:255,fx_delay_time:0,fx_delay_amt:0,fx_pan_freq:0,fx_pan_amt:0,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:4,lfo_amt:27,lfo_waveform:1}},song:{rowLen:5513,endPattern:2,songData:[{osc1_oct:7,osc1_det:0,osc1_detune:0,osc1_xenv:0,osc1_vol:192,osc1_waveform:1,osc2_oct:6,osc2_det:0,osc2_detune:9,osc2_xenv:0,osc2_vol:192,osc2_waveform:1,noise_fader:0,env_attack:137,env_sustain:2e3,env_release:4611,env_master:192,fx_filter:1,fx_freq:982,fx_resonance:89,fx_delay_time:6,fx_delay_amt:25,fx_pan_freq:6,fx_pan_amt:77,lfo_osc1_freq:0,lfo_fx_freq:1,lfo_freq:3,lfo_amt:69,lfo_waveform:0,p:[1],c:[{n:[135,0,0,0,147,0,0,145,0,0,147,0,0,142,0,0,135,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}]}],songLen:9},letters:{"-":[[,,,,0],[,,,,0],[1,1,1,1,1],[,,,,0],[,,,,0]],".":[[,,,,0],[,,,,0],[,,,,0],[,,,,0],[,,1,,0]],1:[[,1,1,,0],[,,1,,0],[,,1,,0],[,,1,,0],[1,1,1,1,1]],2:[[1,1,1,1,0],[,,,,1],[,1,1,1,0],[1,,,,0],[1,1,1,1,1]],3:[[1,1,1,1,0],[,,,,1],[,1,1,1,1],[,,,,1],[1,1,1,1,0]],4:[[1,,,1,0],[1,,,1,0],[1,1,1,1,1],[,,,1,0],[,,,1,0]],5:[[1,1,1,1,1],[1,,,,0],[1,1,1,1,0],[,,,,1],[1,1,1,1,0]],6:[[,1,1,1,0],[1,,,,0],[1,1,1,1,0],[1,,,,1],[,1,1,1,0]],7:[[1,1,1,1,1],[,,,,1],[,,,1,0],[,,1,,0],[,,1,,0]],8:[[,1,1,1,0],[1,,,,1],[,1,1,1,0],[1,,,,1],[,1,1,1,0]],9:[[,1,1,1,0],[1,,,,1],[,1,1,1,1],[,,,,1],[,1,1,1,0]],0:[[,1,1,1,0],[1,,,,1],[1,,,,1],[1,,,,1],[,1,1,1,0]],A:[[1,1,1,1,1],[1,,,,1],[1,1,1,1,1],[1,,,,1],[1,,,,1]],B:[[1,1,1,1,0],[1,,,1,0],[1,1,1,1,1],[1,,,,1],[1,1,1,1,1]],C:[[1,1,1,1,1],[1,,,,0],[1,,,,0],[1,,,,0],[1,1,1,1,1]],D:[[1,1,1,,0],[1,,,1,0],[1,,,,1],[1,,,,1],[1,1,1,1,1]],E:[[1,1,1,1,1],[1,,,,0],[1,1,1,,0],[1,,,,0],[1,1,1,1,1]],F:[[1,1,1,1,1],[1,,,,0],[1,1,1,,0],[1,,,,0],[1,,,,0]],G:[[1,1,1,1,1],[1,,,,0],[1,,1,1,1],[1,,,,1],[1,1,1,1,1]],H:[[1,,,,1],[1,,,,1],[1,1,1,1,1],[1,,,,1],[1,,,,1]],I:[[1,1,1,1,1],[,,1,,0],[,,1,,0],[,,1,,0],[1,1,1,1,1]],J:[[,,,,1],[,,,,1],[,,,,1],[1,,,,1],[1,1,1,1,1]],K:[[1,,,1,0],[1,,1,,0],[1,1,1,,0],[1,,,1,0],[1,,,,1]],L:[[1,,,,0],[1,,,,0],[1,,,,0],[1,,,,0],[1,1,1,1,1]],M:[[1,,,,1],[1,1,,1,1],[1,,1,,1],[1,,,,1],[1,,,,1]],N:[[1,,,,1],[1,1,,,1],[1,,1,,1],[1,,,1,1],[1,,,,1]],O:[[1,1,1,1,1],[1,,,,1],[1,,,,1],[1,,,,1],[1,1,1,1,1]],P:[[1,1,1,1,1],[1,,,,1],[1,1,1,1,1],[1,,,,0],[1,,,,0]],Q:[[1,1,1,1,0],[1,,,1,0],[1,,,1,0],[1,,,1,0],[1,1,1,1,1]],R:[[1,1,1,1,1],[1,,,,1],[1,1,1,1,1],[1,,,1,0],[1,,,,1]],S:[[1,1,1,1,1],[1,,,,0],[1,1,1,1,1],[,,,,1],[1,1,1,1,1]],T:[[1,1,1,1,1],[,,1,,0],[,,1,,0],[,,1,,0],[,,1,,0]],U:[[1,,,,1],[1,,,,1],[1,,,,1],[1,,,,1],[1,1,1,1,1]],V:[[1,,,,1],[1,,,,1],[1,,,,1],[,1,,1,0],[,,1,,0]],W:[[1,,,,1],[1,,,,1],[1,,1,,1],[1,1,,1,1],[1,,,,1]],X:[[1,,,,1],[,1,,1,0],[,,1,,0],[,1,,1,0],[1,,,,1]],Y:[[1,,,,1],[1,,,,1],[1,1,1,1,1],[,,1,,0],[,,1,,0]],Z:[[1,1,1,1,1],[,,,1,0],[,,1,,0],[,1,,,0],[1,1,1,1,1]]," ":[[,,,,0],[,,,,0],[,,,,0],[,,,,0],[,,,,0]],",":[[,,,,0],[,,,,0],[,,,,0],[,,1,,0],[,,1,,0]],"+":[[,,,,0],[,,1,,0],[,1,1,1,0],[,,1,,0],[,,,,0]],"/":[[,,,,1],[,,,1,0],[,,1,,0],[,1,,,0],[1,,,,0]],":":[[,,,,0],[,,1,,0],[,,,,0],[,,1,,0],[,,,,0]],"@":[[1,1,1,1,1],[,,,,1],[1,1,1,,1],[1,,1,,1],[1,1,1,1,1]],x:[[1,,1,,1],[,1,,1,0],[1,,1,,1],[,1,,1,0],[1,,1,,1]],z:[[,1,,1,0],[1,,1,,1],[,1,,1,0],[1,,1,,1],[,1,,1,0]],o:[[1,1,1,1,1],[1,,,,1],[1,,1,,1],[1,,,,1],[1,1,1,1,1]],e:[[1,,,,0],[1,1,,,0],[1,1,1,,0],[1,1,1,1,0],[1,1,1,1,1]],w:[[,,,,1],[,,,1,1],[,,1,1,1],[,1,1,1,1],[1,1,1,1,1]],s:[[1,1,1,1,1],[,1,1,1,1],[,,1,1,1],[,,,1,1],[,,,,1]],d:[[1,1,1,1,1],[1,1,1,1,0],[1,1,1,,0],[1,1,,,0],[1,,,,0]],t:[[0,0,0,1,1],[0,0,1,1,1],[0,0,1,1,1],[0,0,1,1,1],[0,0,1,1,1]],y:[[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1]],u:[[1,1,0,0,0],[1,1,1,0,0],[0,0,1,0,0],[0,1,1,0,0],[1,1,1,0,0]],g:[[0,0,1,1,1],[0,0,0,1,1],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,1]],h:[[1,1,1,1,1],[1,1,1,1,1],[0,1,1,1,0],[1,1,1,1,1],[1,1,1,1,1]],j:[[1,1,1,0,0],[1,1,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[1,1,1,1,1]],b:[[0,0,0,1,1],[0,0,0,1,1],[0,0,0,0,1],[0,0,0,0,1],[0,0,0,0,1]],n:[[1,1,1,1,1],[1,1,1,1,1],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0]],a:[[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1]]}},Entity=function(e){e||(e={radius:10,gravity:0,frictX:.92,frictY:.94}),this.cx=0,this.cy=0,this.xr=0,this.yr=0,this.xx=0,this.yy=0,this.dx=0,this.dy=0,this.collided=!1,this.ox=0,this.oy=0,this.radius=e.radius||10,this.gravity=e.gravity||0,this.bounce=e.bounce||0,this.frictX=e.frictX||.92,this.frictY=e.frictY||.94,this.dead=!1,this.collides=e.collides||0,this.mapcollide=e.mapcollide||0,this.id=Math.random()},Entity.prototype.setCoords=function(e,t){this.xx=e,this.yy=t,this.cx=Math.floor(this.xx/Const.GRID),this.cy=Math.floor(this.yy/Const.GRID),this.xr=(this.xx-this.cx*Const.GRID)/Const.GRID,this.yr=(this.yy-this.cy*Const.GRID)/Const.GRID},Entity.prototype.hasCollision=function(e,t){return!!this.mapcollide&&(void 0!=Assets.map[t]&&void 0!=Assets.map[t][e]&&Assets.map[t][e])},Entity.prototype.overlaps=function(e,t){var n=e.radius+t.radius;return(t.xx-e.xx)*(t.xx-e.xx)+(t.yy-e.yy)*(t.yy-e.yy)<=n*n},Entity.prototype.onGround=function(){return this.hasCollision(this.cx,this.cy+1)&&this.yr>=.5},Entity.prototype.onCeiling=function(){return this.hasCollision(this.cx,this.cy-1)&&.5>=this.yr},Entity.prototype.onWallLeft=function(){return this.hasCollision(this.cx-1,this.cy)&&.5>=this.xr},Entity.prototype.onWallRight=function(){return this.hasCollision(this.cx+1,this.cy)&&this.xr>=.5},Entity.prototype.update=function(){for(this.xr+=this.dx,this.dx*=this.frictX,this.hasCollision(this.cx-1,this.cy)&&.3>=this.xr&&(this.dx=0,this.xr=.3),this.hasCollision(this.cx+1,this.cy)&&this.xr>=.7&&(this.dx=0,this.xr=.7);0>this.xr;)this.cx--,this.xr++;for(;this.xr>1;)this.cx++,this.xr--;for(this.dy+=this.gravity,this.yr+=this.dy,this.dy*=this.frictY,this.hasCollision(this.cx,this.cy-1)&&.4>=this.yr&&(this.dy=0,this.yr=.4),this.hasCollision(this.cx,this.cy+1)&&this.yr>=.7&&(this.dy=this.bounce?-this.dy:0,this.bounce||(this.yr=.7));0>this.yr;)this.cy--,this.yr++;for(;this.yr>1;)this.cy++,this.yr--;this.xx=Math.floor((this.cx+this.xr)*Const.GRID),this.yy=Math.floor((this.cy+this.yr)*Const.GRID),this.ox=(this.cx+this.xr)*Const.GRID,this.oy=(this.cy+this.yr)*Const.GRID},Entity.prototype.collide=function(t,n){var r=Math.sqrt((t.xx-n.xx)*(t.xx-n.xx)+(t.yy-n.yy)*(t.yy-n.yy));if(r<=t.radius+n.radius){this.collided=!0;var i=Math.atan2(t.yy-n.yy,t.xx-n.xx),o=(n.radius+t.radius-r)/(n.radius+t.radius);this.dx-=Math.cos(i)*o*.03,this.dy-=Math.sin(i)*o*.03,e.dx+=Math.cos(i)*o*.03,e.dy+=Math.sin(i)*o*.03}};var h={},d=2,y=33,p=null,v=[r,i,o,a];h.AudioGenerator=function(e){this.mixBuf=e,this.waveSize=e.length/d/2},h.AudioGenerator.prototype.getWave=function(){var e,t,n,r,i,o,a,s=this.mixBuf,l=this.waveSize*d*2;for(o=(i=l-8)-36,r=String.fromCharCode(82,73,70,70,255&i,i>>8&255,i>>16&255,i>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&o,o>>8&255,o>>16&255,o>>24&255),e=0;l>e;){for(n="",t=0;256>t&&l>e;++t,e+=2)a=-32768>(a=4*(s[e]+(s[e+1]<<8)-32768))?-32768:a>32767?32767:a,n+=String.fromCharCode(255&a,a>>8&255);r+=n}return r},h.AudioGenerator.prototype.getAudio=function(){var e=this.getWave(),t=new Audio("data:audio/wav;base64,"+btoa(e));return t.preload="none",t.load(),t},h.AudioGenerator.prototype.getAudioBuffer=function(e){null===p&&(p=new AudioContext);var t=this.mixBuf,n=this.waveSize*d*2,r=p.createBuffer(d,this.waveSize,44100),i=r.getChannelData(0),o=r.getChannelData(1),a=0,s=function(){for(var l=new Date,c=0;n/2>a;){var u=4*(t[4*a]+(t[4*a+1]<<8)-32768);if(u=-32768>u?-32768:u>32767?32767:u,i[a]=u/32768,u=4*(t[4*a+2]+(t[4*a+3]<<8)-32768),u=-32768>u?-32768:u>32767?32767:u,o[a]=u/32768,a+=1,(c+=1)%1e3==0&&new Date-l>y)return void setTimeout(s,0)}setTimeout(function(){e(r)},0)};setTimeout(s,0)},h.SoundGenerator=function(e,t){this.instr=e,this.rowLen=t||5605,this.osc_lfo=v[e.lfo_waveform],this.osc1=v[e.osc1_waveform],this.osc2=v[e.osc2_waveform],this.attack=e.env_attack,this.sustain=e.env_sustain,this.release=e.env_release,this.panFreq=Math.pow(2,e.fx_pan_freq-8)/this.rowLen,this.lfoFreq=Math.pow(2,e.lfo_freq-8)/this.rowLen},h.SoundGenerator.prototype.genSound=function(e,t,n){new Date;for(var i=0,o=0,a=s(e+12*(this.instr.osc1_oct-8)+this.instr.osc1_det)*(1+8e-4*this.instr.osc1_detune),l=s(e+12*(this.instr.osc2_oct-8)+this.instr.osc2_det)*(1+8e-4*this.instr.osc2_detune),c=this.instr.fx_resonance/255,u=0,f=0,h=this.attack+this.sustain+this.release-1;h>=0;--h){var d=h+n,y=this.osc_lfo(d*this.lfoFreq)*this.instr.lfo_amt/512+.5,p=1;h<this.attack?p=h/this.attack:h<this.attack+this.sustain||(p-=(h-this.attack-this.sustain)/this.release);var v=a;this.instr.lfo_osc1_freq&&(v+=y),this.instr.osc1_xenv&&(v*=p*p),i+=v;var x=this.osc1(i)*this.instr.osc1_vol;v=l,this.instr.osc2_xenv&&(v*=p*p),o+=v,x+=this.osc2(o)*this.instr.osc2_vol,this.instr.noise_fader&&(x+=(2*Math.random()-1)*this.instr.noise_fader*p),x*=p/255;var g=this.instr.fx_freq;this.instr.lfo_fx_freq&&(g*=y);var m=c*(x-f)-(u+=(g=1.5*Math.sin(3.141592*g/44100))*f);switch(f+=g*m,this.instr.fx_filter){case 1:x=m;break;case 2:x=u;break;case 3:x=f;break;case 4:x=u+m}if(v=r(d*this.panFreq)*this.instr.fx_pan_amt/512+.5,x*=39*this.instr.env_master,(d*=4)+3<t.length){var w=t[d]+(t[d+1]<<8)+x*(1-v);t[d]=255&w,t[d+1]=w>>8&255,w=t[d+2]+(t[d+3]<<8)+x*v,t[d+2]=255&w,t[d+3]=w>>8&255}}},h.SoundGenerator.prototype.getAudioGenerator=function(e,t){var n=this.attack+this.sustain+this.release-1+32*this.rowLen,r=this;l(n,function(i){r.genSound(e,i,0),c(i,n,r.instr,r.rowLen,function(){t(new h.AudioGenerator(i))})})},h.SoundGenerator.prototype.createAudio=function(e,t){this.getAudioGenerator(e,function(e){t(e.getAudio())})},h.SoundGenerator.prototype.createAudioBuffer=function(e,t){this.getAudioGenerator(e,function(e){e.getAudioBuffer(t)})},h.MusicGenerator=function(e){this.song=e,this.waveSize=44100*e.songLen},h.MusicGenerator.prototype.generateTrack=function(e,t,n){var r=this;l(this.waveSize,function(i){var o=r.waveSize,a=r.waveSize*d*2,s=r.song.rowLen,l=r.song.endPattern,u=new h.SoundGenerator(e,s),f=0,p=0,v=0,x=function(){for(var t=new Date;;)if(32!==v){if(p===l-1)return void setTimeout(g,0);var n=e.p[p];if(n){var r=e.c[n-1].n[v];r&&u.genSound(r,i,f)}if(f+=s,v+=1,new Date-t>y)return void setTimeout(x,0)}else v=0,p+=1},g=function(){c(i,o,e,s,w)},m=0,w=function(){for(var e=new Date,r=0;a>m;){var o=t[m]+(t[m+1]<<8)+i[m]+(i[m+1]<<8)-32768;if(t[m]=255&o,t[m+1]=o>>8&255,m+=2,(r+=1)%1e3==0&&new Date-e>y)return void setTimeout(w,0)}setTimeout(n,0)};setTimeout(x,0)})},h.MusicGenerator.prototype.getAudioGenerator=function(e){var t=this;l(this.waveSize,function(n){var r=0,i=function(){r<t.song.songData.length?(r+=1,t.generateTrack(t.song.songData[r-1],n,i)):e(new h.AudioGenerator(n))};i()})},h.MusicGenerator.prototype.createAudio=function(e){this.getAudioGenerator(function(t){e(t.getAudio())})},h.MusicGenerator.prototype.createAudioBuffer=function(e){this.getAudioGenerator(function(t){t.getAudioBuffer(e)})};var x=function(){function e(e){return r.appendChild(e.dom),e}function t(e){for(var t=0;t<r.children.length;t++)r.children[t].style.display=t===e?"block":"none";n=e}var n=0,r=document.createElement("div");r.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",r.addEventListener("click",function(e){e.preventDefault(),t(++n%r.children.length)},!1);var i=(performance||Date).now(),o=i,a=0,s=e(new x.Panel("FPS","#0ff","#002")),l=e(new x.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=e(new x.Panel("MB","#f08","#201"));return t(0),{REVISION:16,dom:r,addPanel:e,showPanel:t,begin:function(){i=(performance||Date).now()},end:function(){a++;var e=(performance||Date).now();if(l.update(e-i,200),e>o+1e3&&(s.update(1e3*a/(e-o),100),o=e,a=0,c)){var t=performance.memory;c.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){i=this.end()},domElement:r,setMode:t}};x.Panel=function(e,t,n){var r=1/0,i=0,o=Math.round,a=o(window.devicePixelRatio||1),s=80*a,l=48*a,c=3*a,u=2*a,f=3*a,h=15*a,d=74*a,y=30*a,p=document.createElement("canvas");p.width=s,p.height=l,p.style.cssText="width:80px;height:48px";var v=p.getContext("2d");return v.font="bold "+9*a+"px Helvetica,Arial,sans-serif",v.textBaseline="top",v.fillStyle=n,v.fillRect(0,0,s,l),v.fillStyle=t,v.fillText(e,c,u),v.fillRect(f,h,d,y),v.fillStyle=n,v.globalAlpha=.9,v.fillRect(f,h,d,y),{dom:p,update:function(l,x){r=Math.min(r,l),i=Math.max(i,l),v.fillStyle=n,v.globalAlpha=1,v.fillRect(0,0,s,h),v.fillStyle=t,v.fillText(o(l)+" "+e+" ("+o(r)+"-"+o(i)+")",c,u),v.drawImage(p,f+a,h,d-a,y,f,h,d-a,y),v.fillRect(f+d-a,h,a,y),v.fillStyle=n,v.globalAlpha=.9,v.fillRect(f+d-a,h,a,o((1-l/x)*y))}}},"object"==typeof module&&(module.exports=x),Key={_pressed:{},_released:{},LEFT:37,UP:38,RIGHT:39,DOWN:40,SPACE:32,a:65,w:87,s:83,d:68,z:90,x:88,f:70,p:80,r:82,isDown:function(e){return this._pressed[e]},justReleased:function(e){return this._released[e]},onKeydown:function(e){this._pressed[e.keyCode]=!0},onKeyup:function(e){this._released[e.keyCode]=!0,delete this._pressed[e.keyCode]},update:function(){this._released={}}},Txt={textLine:function(e){for(var t=e.text.length,n=0;t>n;n++)for(var r=g.assets.letters[e.text.charAt(n)]||g.assets.letters.unknown,i=0;5>i;i++)for(var o=0;5>o;o++)1===r[i][o]&&(1===e.scale?g.gfx.pset(e.x+o*e.scale+(5*e.scale+e.hspacing)*n,e.y+i*e.scale,e.color):g.gfx.fillRect(e.x+o*e.scale+(5*e.scale+e.hspacing)*n,e.y+i*e.scale,e.x+o*e.scale+(5*e.scale+e.hspacing)*n+e.scale,e.y+i*e.scale+e.scale,e.color))},text:function(e){var t=5*e.scale,n=e.text.split("\n"),r=n.slice(0),i=n.length,o=r.sort(function(e,t){return t.length-e.length})[0],a=o.length*t+(o.length-1)*e.hspacing,s=i*t+(i-1)*e.vspacing,l=e.x,c=e.y,u=e.x+a,f=e.y+s;"center"==e.halign?(l=e.x-a/2,u=e.x+a/2):"right"==e.halign&&(l=e.x-a,u=e.x),"center"==e.valign?(c=e.y-s/2,f=e.y+s/2):"bottom"==e.valign&&(c=e.y-s,f=e.y);var h=l+a/2,d=c+s/2;if(e.render)for(var y=0;i>y;y++){var p=n[y],v=p.length*t+(p.length-1)*e.hspacing,x=e.x,g=e.y+(t+e.vspacing)*y;"center"==e.halign?x=e.x-v/2:"right"==e.halign&&(x=e.x-v),"center"==e.valign?g-=s/2:"bottom"==e.valign&&(g-=s),e.snap&&(x=Math.floor(x),g=Math.floor(g)),this.textLine({ctx:e.ctx,x:x,y:g,text:p,hspacing:e.hspacing||0,scale:e.scale||1,color:e.color})}return{sx:l,sy:c,cx:h,cy:d,ex:u,ey:f,width:a,height:s}}},u.boot={onenter:function(e,t,n){g.sounds={},p&&p.close(),window.AudioContext=window.AudioContext||window.webkitAudioContext,p||(p=new AudioContext),new h.MusicGenerator(g.assets.song).createAudioBuffer(function(e){g.sounds.song=e}),g.stars=[];for(var r=0;300>r;r++)g.stars.push({x:256*Math.random(),y:256*Math.random(),speed:6*Math.random()});g.t=0,g.moveX=0,g.speedFactor=.6,g.songTrigger=!1},onexit:function(e,t,n){},step:function(e){Key.isDown(Key.p)&&"boot"==fsm.current&&fsm.ready()},render:function(e){g.gfx.fillRect(0,0,256,256,0),g.gfx.fillRect(0,0,64,64,2),Txt.text({x:128,y:40+15*Math.sin(2.5*g.t),text:"BOOT",hspacing:8+4*Math.cos(2.9*g.t),vspacing:15+5*Math.sin(3.5*g.t),halign:"center",valign:"top",scale:10,snap:1,render:1,color:21})}},u.gameover={onenter:function(e,t,n){},onexit:function(e,t,n){},step:function(e){Key.isDown(Key.r)&&fsm.reset()},render:function(e){g.gfx.fillRect(0,0,256,256,0),g.gfx.fillRect(0,0,64,64,2),Txt.text({x:128,y:40+15*Math.sin(2.5*g.t),text:"GAME\nOVER",hspacing:8+4*Math.cos(2.9*g.t),vspacing:15+5*Math.sin(3.5*g.t),halign:"center",valign:"top",scale:10,snap:1,render:1,color:21})}},u.menu={onenter:function(e,t,n){},onexit:function(e,t,n){},step:function(e){Key.isDown(Key.r)&&fsm.play()},render:function(e){g.gfx.fillRect(0,0,256,256,0),g.gfx.fillRect(0,0,64,64,2),Txt.text({x:128,y:40+15*Math.sin(2.5*g.t),text:"MENU",hspacing:8+4*Math.cos(2.9*g.t),vspacing:15+5*Math.sin(3.5*g.t),halign:"center",valign:"top",scale:10,snap:1,render:1,color:21})}},u.game={onenter:function(){g.sounds={},window.AudioContext=window.AudioContext||window.webkitAudioContext,p=new AudioContext,new h.MusicGenerator(g.assets.song).createAudioBuffer(function(e){g.sounds.song=e}),bulletPool=new t(100,n),bulletPool.init(),g.songTrigger=!1,g.player.init()},onexit:function(e,t,n){},step:function(e){g.cos=Math.cos(e),g.sin=Math.sin(e);for(var t=0;t<g.stars.length;t++){let e=g.stars[t];e.y+=e.speed*g.speedFactor*(1+2*g.util.norm(e.y,0,365)),e.y>365&&(e.y=0,e.x=256*Math.random())}g.player.update(e),Key.isDown(Key.z)&&(g.songTrigger=!0),g.songTrigger&&(g.songTrigger=!1,g.playSound(g.sounds.song,1,1,0)),bulletPool.use()},render:function(e){g.renderTarget=65536,g.gfx.fillRect(0,0,256,256,0);for(let e=0;e<g.stars.length;e++){let t=1.40625*g.stars[e].x*.0174533,n=g.stars[e].y/2,r=g.util.polarToPoint(t,n);g.gfx.pset(r.x+128,r.y+128,16)}g.gfx.fillCircle(128,128,10,0),g.player.draw();var t=bulletPool.getPool();for(let e=0;e<t.length;e++)if(!t[e].dead){bulletScreenPoint=g.util.toPolarScreen({x:t[e].x,y:t[e].y});let n=g.util.dist(bulletScreenPoint.x+128,bulletScreenPoint.y+128,128,128),r=g.util.norm(n,0,128);g.gfx.fillCircle(bulletScreenPoint.x+128,bulletScreenPoint.y+128,4*r,21)}g.renderTarget=g.page3;for(var n=3e3;n--;){var r=256*Math.random()|0,i=256*Math.random()|0,o=g.ram[g.page1+(256*i+r)];g.gfx.pset(r,i,o-1)}g.renderTarget=g.page2,g.gfx.clear(0),Txt.text({x:8,y:240,text:"X: "+(""+g.player.x).substring(0,7)+"\nY: "+(""+g.player.y).substring(0,7),hspacing:2,vspacing:2,halign:"left",valign:"top",scale:1,snap:1,render:1,color:21}),g.renderSource=g.page3,g.renderTarget=g.screen,g.gfx.clear(1),g.gfx.spr(0,0,256,256),g.renderSource=g.page1,g.renderTarget=g.screen,g.gfx.spr(0,0,256,256),g.renderSource=g.page2,g.renderTarget=g.screen,g.gfx.spr(0,0,256,256),g.renderTarget=g.page5,g.gfx.checker(64,64,18),g.gfx.fillRect(64,16,66,32,g.White),g.gfx.fillRect(64,16,68,20,g.PinkPlum),g.renderSource=g.page5,g.renderTarget=g.screen,g.gfx.spr(64,16,16,16,200,200),g.renderSource=g.page5,g.renderTarget=g.screen,g.gfx.rspr(64,16,16,16,64,64,3,1)}},g.player={bullet:{x:0,y:0,xvel:0,yvel:0},init:function(){this.x=64,this.y=230,this.radius=12,this.xvel=0,this.yvel=0,this.xspeed=200,this.yspeed=400,this.drag=.6},update:function(e){g.player.bullet.x=g.player.x,g.player.bullet.y=g.player.y,g.player.xvel*=g.player.drag,g.player.yvel*=g.player.drag;let t=e*g.player.xvel,n=e*g.player.yvel;g.player.x+=t,g.player.y+=n,(Key.isDown(Key.d)||Key.isDown(Key.RIGHT))&&(g.player.xvel=-g.player.xspeed),(Key.isDown(Key.a)||Key.isDown(Key.LEFT))&&(g.player.xvel=g.player.xspeed),(Key.isDown(Key.w)||Key.isDown(Key.UP))&&(g.player.yvel=-g.player.yspeed),(Key.isDown(Key.s)||Key.isDown(Key.DOWN))&&(g.player.yvel=g.player.yspeed),Key.isDown(Key.SPACE||Key.isDown(Key.z))&&(g.player.bullet.yvel=-350,bulletPool.get(g.player.bullet)),g.player.x>256&&(g.player.x=0),0>g.player.x&&(g.player.x=256),g.player.y>365&&(g.player.y=0),0>g.player.y&&(fsm.lose(),g.player.y=256)},draw:function(e){let t=g.util.toPolarScreen({x:g.player.x,y:g.player.y}),n=g.util.dist(t.x+128,t.y+128,128,128),r=g.util.norm(n,0,128);g.renderTarget=g.page1,g.gfx.fillCircle(t.x+128,t.y+128,g.player.radius*r,21)}};var g=ENGINE;init=function(){g.last=0,g.dt=0,g.now=0,g.t=0,stats=new x,document.body.appendChild(stats.dom),g.canvasInit(),fsm=f.create({initial:"init",events:[{name:"load",from:"init",to:"boot"},{name:"ready",from:"boot",to:"menu"},{name:"play",from:["menu","gameover"],to:"game"},{name:"lose",from:["game","gameover"],to:"gameover"},{name:"reset",from:["init","boot","menu","gameover","game"],to:"boot"}],callbacks:{onenterboot:function(e,t,n){u.boot.onenter(e,t,n)},onentermenu:function(e,t,n){u.menu.onenter(e,t,n)},onleavemenu:function(e,t,n){u.menu.onexit(e,t,n)},onentergame:function(e,t,n){u.game.onenter(e,t,n)},onleavegame:function(e,t,n){u.game.onexit(e,t,n)},onentergameover:function(e,t,n){u.gameover.onenter(e,t,n)}}}),window.addEventListener("keyup",function(e){Key.onKeyup(e)},!1),window.addEventListener("mousedown",function(e){stopCapture(e)},!1),window.addEventListener("keydown",function(e){Key.onKeydown(e)},!1),window.addEventListener("blur",function(e){paused=!0},!1),window.addEventListener("focus",function(e){paused=!1},!1),window.addEventListener("resize",function(){g.canvas.width=window.innerWidth,g.canvas.height=window.innerHeight}),fsm.load(),loop()},stopCapture=function(e){g.capturer.stop(),g.capturer.save()},loop=function(){stats.begin();let e=(new Date).getTime();g.dt=Math.min(1,(e-g.last)/1e3),g.t+=g.dt,u[fsm.current].render(),u[fsm.current].step(g.dt),g.last=e,g.render(),stats.end(),requestAnimationFrame(loop)},window.onload=init()}();
</script></body></html>