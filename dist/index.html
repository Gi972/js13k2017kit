<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Game Zero ES6</title><style>
body{margin:0;overflow:hidden;background:#111;color:#ccc}#canvas{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%;image-rendering:optimizeSpeed;image-rendering:-moz-crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:-o-crisp-edges;image-rendering:pixelated;-ms-interpolation-mode:nearest-neighbor;cursor:none;margin:auto}
</style></head><body><canvas id="canvas"></canvas><script>
var GAME=function(){function e(e,t){return e=t>e?t:e}function t(e,t){return e=e>t?t:e}function n(e){return Math.abs(e)%1}function r(e,t){var n=e,r=[];this.init=function(){for(var e=0;n>e;e++){var i=new t;i.init(),r[e]=i}},this.get=function(e){if(!r[n-1].inUse)return r[n-1].spawn(e),r.unshift(r.pop()),r[n-1]},this.getPool=function(){return r},this.use=function(){for(var e=0;n>e&&r[e].inUse;e++)r[e].use(w.dt)&&(r[e].clear(),r.push(r.splice(e,1)[0]))}}function i(){this.inUse=!1,this.init=function(){this.x=-500,this.y=-500,this.dead=!0,this.xvel=0,this.yvel=1,this.life=1},i.prototype.spawn=function(e){this.x=e.x,this.y=e.y,this.xvel=e.xvel,this.yvel=e.yvel,this.inUse=!0,this.life=e.life||1,this.remaining=e.life||1,this.radius=e.radius||1,this.color=e.color||w.WHITE,this.dead=!1},i.prototype.use=function(e){return!!this.dead||(this.remaining-=w.dt,this.x+=w.dt*this.xvel,this.y+=w.dt*this.yvel,this.draw(),this.remaining>0?(0>this.y&&(this.dead=!0),!1):(this.dead=!0,!0))},i.prototype.clear=function(){this.x=-500,this.y=-500,this.dead=!0,this.xvel=0,this.yvel=0,this.life=1,this.inUse=!1},i.prototype.draw=function(){w.gfx.circle(this.x,this.y,0|4*Math.random(),21)}}function o(e){return Math.sin(6.283184*e)}function a(e){return 0>o(e)?-1:1}function s(e){return e%1-.5}function c(e){var t=e%1*4;return 2>t?t-1:3-t}function u(e){return.00390625*Math.pow(1.059463094,e-128)}function f(e,t){setTimeout(function(){var n=new Uint8Array(e*p*2),r=n.length-2,i=function(){for(var e=new Date,o=0;r>=0;)if(n[r]=0,n[r+1]=128,r-=2,(o+=1)%1e3==0&&new Date-e>g)return void setTimeout(i,0);setTimeout(function(){t(n)},0)};setTimeout(i,0)},0)}function l(e,t,n,r,i){var o=n.fx_delay_time*r>>1,a=n.fx_delay_amt/255,s=0,c=function(){for(var n=new Date,r=0;t-o>s;){var u=4*s,f=4*(s+o),l=e[f]+(e[f+1]<<8)+(e[u+2]+(e[u+3]<<8)-32768)*a;if(e[f]=255&l,e[f+1]=l>>8&255,l=e[f+2]+(e[f+3]<<8)+(e[u]+(e[u+1]<<8)-32768)*a,e[f+2]=255&l,e[f+3]=l>>8&255,++s,(r+=1)%1e3==0&&new Date-n>g)return void setTimeout(c,0)}setTimeout(i,0)};setTimeout(c,0)}var h={};ENGINE={E:this,screen:0,page1:65536,page2:131072,page3:196608,page4:262144,page5:327680,page6:393216,page7:458752,colors:[4278190080,4281606178,4282132549,4281416038,4282078863,4280709599,4284915929,4288332782,4281791227,4283491737,4281384554,4285436983,4281297227,4280568658,4281941042,4285808447,4286734384,4292963931,4294941539,4293184863,4294761419,4294967295,4290227611,4287069828,4285164137,4283586137,4287251062,4281479852,4284700633,4290411479,4283078543,4281364362],palDefault:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],pal:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],renderTarget:0,renderSource:65536,currentState:0,playSound:function(e,t,n,r){var i=m.createBufferSource(),o=m.createGain(),a=m.createStereoPanner();return i.buffer=e,i.connect(a),a.connect(o),o.connect(m.destination),i.playbackRate.value=t,i.loop=r,o.gain.value=1,a.pan.value=n,i.start(),{volume:o,sound:i}},gfx:{clear:function(e){w.ram.fill(e,w.renderTarget,w.renderTarget+65536)},pset(e,t,n){t|=0,(e|=0)>-1&&256>e&&t>-1&&256>t&&(w.ram[w.renderTarget+(256*t+e)]=n)},line(e,t,n,r,i){var o,a,s=(r|=0)-(t|=0),c=(n|=0)-(e|=0);if(0>s?(s=-s,a=-1):a=1,0>c?(c=-c,o=-1):o=1,s<<=1,c<<=1,this.pset(e,t,i),c>s)for(var u=s-(c>>1);e!=n;)0>u||(t+=a,u-=c),e+=o,u+=s,this.pset(e,t,i);else for(u=c-(s>>1);t!=r;)0>u||(e+=o,u-=s),t+=a,u+=c,this.pset(e,t,i)},circle(e,t,n,r){var i=-n,o=0,a=2-2*n;do{this.pset(e-i,t+o,r),this.pset(e-o,t-i,r),this.pset(e+i,t-o,r),this.pset(e+o,t+i,r),(n=a)>o||(a+=2*++o+1),(n>i||a>o)&&(a+=2*++i+1)}while(0>i)},fillCircle(e,t,n,r){e|=0,t|=0,r|=0;var i=-(n|=0),o=0,a=2-2*n;do{this.line(e-i,t-o,e+i,t-o,r),this.line(e-i,t+o,e+i,t+o,r),(n=a)>o||(a+=2*++o+1),(n>i||a>o)&&(a+=2*++i+1)}while(0>i)},rect(e,t,n,r,i){e|=0,n|=0,t|=0,r|=0,this.line(e,t,n,t,i),this.line(n,t,n,r,i),this.line(e,r,n,r,i),this.line(e,t,e,r,i)},fr(e,t,n,r,i){e|=0,n|=0,t|=0,r|=0;var o=Math.abs(r-t);if(w.gfx.line(e,t,n,t,i),o>0)for(;--o;)w.gfx.line(e,t+o,n,t+o,i);w.gfx.line(e,r,n,r,i)},triangle(e,t,n,r,i,o,a){w.gfx.line(e,t,n,r,a),w.gfx.line(n,r,i,o,a),w.gfx.line(i,o,e,t,a)},fillTriangle(e,t,n,r,i,o,a){var e=Math.round(16*e),n=Math.round(16*n),i=Math.round(16*i),t=Math.round(16*t),s=e-n,c=(r=Math.round(16*r))-t,u=n-i,f=(o=Math.round(16*o))-r,l=i-e,h=t-o,d=Math.max(Math.min(e,n,i)+15>>4,0),v=Math.min(Math.max(e,n,i)+15>>4,256),p=Math.max(Math.min(t,r,o)+15>>4,0),g=Math.min(Math.max(t,r,o)+15>>4,256);d&=-8,p&=-8;var m=-c*e-s*t,y=-f*n-u*r,x=-h*i-l*o;(c>0||0==c&&s>0)&&m++,(f>0||0==f&&u>0)&&y++,(h>0||0==h&&l>0)&&x++,m=m-1>>4,y=y-1>>4,x=x-1>>4;var _=0,S=0,A=0,b=0,T=0,E=0;0>s?_-=7*s:S-=7*s,0>c?_-=7*c:S-=7*c,0>u?A-=7*u:b-=7*u,0>f?A-=7*f:b-=7*f,0>l?T-=7*l:E-=7*l,0>h?T-=7*h:E-=7*h;for(var D=p;g>D;D+=8)for(var C=d;v>C;C+=8){var M=m+s*D+c*C,I=y+u*D+f*C,N=x+l*D+h*C;if(!(S>M||b>I||E>N)){var k=C+256*D;if(M<_||I<A||N<T)for(R=0;8>R;R++){for(var L=M,G=I,K=N,P=0;8>P;P++)0>(L|G|K)||(w.ram[w.renderTarget+k]=a),L+=c,G+=f,K+=h,k++;M+=s,I+=u,N+=l,k+=248}else for(var R=0;8>R;R++){for(P=0;8>P;P++,k++)w.ram[w.renderTarget+k]=a;k+=248}}}},spr(e=0,t=0,n=16,r=16,i=0,o=0,a=!1,s=!1){for(var c=0;r>c;c++)for(var u=0;n>u;u++)255>o+c&&255>i+u&&o+c>-1&&i+u>-1&&(a&s?w.ram[w.renderSource+(256*(t+(r-c))+e+(n-u))]>0&&(w.ram[w.renderTarget+(256*(o+c)+i+u)]=w.pal[w.ram[w.renderSource+(256*(t+(r-c))+e+(n-u))]]):s&&!a?w.ram[w.renderSource+(256*(t+(r-c))+e+u)]>0&&(w.ram[w.renderTarget+(256*(o+c)+i+u)]=w.ram[w.renderSource+(256*(t+(r-c))+e+u)]):a&&!s?w.ram[w.renderSource+(256*(t+c)+e+(n-u))]>0&&(w.ram[w.renderTarget+(256*(o+c)+i+u)]=w.ram[w.renderSource+(256*(t+c)+e+(n-u))]):a||s||w.ram[w.renderSource+(256*(t+c)+e+u)]>0&&(w.ram[w.renderTarget+(256*(o+c)+i+u)]=w.pal[w.ram[w.renderSource+(256*(t+c)+e+u)]]))},sspr(e=0,t=0,n=16,r=16,i=0,o=0,a=16,s=16,c=!1,u=!1){for(var f=n/a,l=r/s,h=0;s>h;h++)for(var d=0;a>d;d++)px=d*f|0,py=h*l|0,255>o+h&&255>i+d&&o+h>-1&&i+d>-1&&w.ram[w.renderSource+(256*(t+py)+e+px)]>0&&(w.ram[w.renderTarget+(256*(o+h)+i+d)]=w.ram[w.renderSource+(256*(t+py)+e+px)])},rspr(e,t,n,r,i,o,a,s){s*=.0174533;var c=e+n/2,u=t+r/2,f=n*a/2*1.41421356237|5,l=r*a/2*1.41421356237|5,h=-f,d=f,v=-l,p=l,g=1/a,m=Math.cos(-s)*g,y=Math.sin(-s)*g;for(let e=v;p>e;e++)for(let t=h;d>t;t++){let a=c+Math.round(m*t+y*e),s=u+Math.round(-y*t+m*e),f=t+i|0,l=e+o|0;a>=0&&s>=0&&n>a&&r>s&&w.ram[w.renderSource+(256*s+a)]>0&&(w.ram[w.renderTarget+(256*l+f)]=w.ram[w.renderSource+(256*s+a)])}},checker(e,t,n,r,i){var o=0,a=0;n=n||8,e/=r=r||8,t/=n;for(var s=0;n>s;++s)for(var c=0,u=r/2;u>c;++c)o=2*c*e+(s%2?0:e),a=s*t,w.gfx.fr(o,a,o+e-1,a+t-1,i)}},util:{toPolarScreen(e){let t=1.40625*e.x*.0174533,n=e.y/2;return w.util.polarToPoint(t,n)},norm(e,t,n){return(e-t)/(n-t)},dist(e,t,n,r){if(2===arguments.length)return this.dist(e.x,e.y,t.x,t.y);var i=n-e,o=r-t;return Math.sqrt(i*i+o*o)},polarToPoint(e,t){return{x:Math.cos(e)*t,y:Math.sin(e)*t}},pointToPolar(e){return{angle:Math.atan2(e.y,e.x),radius:this.magnitude(e)}},magnitude(e){return this.dist(0,0,e.x,e.y)},scale(e){}},canvasInit(){w.C=document.getElementById("canvas"),w.ctx=canvas.getContext("2d"),w.C.width=window.innerWidth,w.C.height=window.innerHeight,w.ctx.imageSmoothingEnabled=!1,w.ctx.mozImageSmoothingEnabled=!1,w.sc=document.createElement("canvas"),w.smallctx=w.sc.getContext("2d"),w.sc.width=256,w.sc.height=256,w.canvasHeight=w.sc.height,w.canvasWidth=w.sc.width,w.imageData=w.smallctx.getImageData(0,0,w.canvasWidth,w.canvasHeight),w.buf=new ArrayBuffer(w.imageData.data.length),w.buf8=new Uint8ClampedArray(w.buf),w.data=new Uint32Array(w.buf),w.ram=new Uint8ClampedArray(524288),w.renderTarget=w.screen},render(){for(var e=65536;e--;)w.data[e]=w.colors[w.pal[w.ram[e]]];w.imageData.data.set(w.buf8),w.smallctx.putImageData(w.imageData,0,0),w.compositeSize=window.innerWidth<window.innerHeight?window.innerWidth:window.innerHeight,w.compositeOrigin=(window.innerWidth-w.compositeSize)/2|0,w.ctx.imageSmoothingEnabled=!1,w.ctx.mozImageSmoothingEnabled=!1,w.ctx.drawImage(w.sc,0,0,255,255,w.compositeOrigin,0,w.compositeSize,w.compositeSize)}};w=ENGINE;Number.prototype.map=function(e,t,n,r){return(this-e)*(r-n)/(t-e)+n};var d={VERSION:"2.3.5",Result:{SUCCEEDED:1,NOTRANSITION:2,CANCELLED:3,PENDING:4},Error:{INVALID_TRANSITION:100,PENDING_TRANSITION:200,INVALID_CALLBACK:300},WILDCARD:"*",ASYNC:"async",create:function(e,t){var n="string"==typeof e.initial?{state:e.initial}:e.initial,r=e.terminal||e.final,i=t||e.target||{},o=e.events||[],a=e.callbacks||{},s={},c={},u=function(e){var t=e.from instanceof Array?e.from:e.from?[e.from]:[d.WILDCARD];s[e.name]=s[e.name]||{};for(var n=0;n<t.length;n++)c[t[n]]=c[t[n]]||[],c[t[n]].push(e.name),s[e.name][t[n]]=e.to||t[n]};n&&(n.event=n.event||"startup",u({name:n.event,from:"none",to:n.state}));for(var f=0;o.length>f;f++)u(o[f]);for(var l in s)s.hasOwnProperty(l)&&(i[l]=d.buildEvent(l,s[l]));for(var l in a)a.hasOwnProperty(l)&&(i[l]=a[l]);return i.current="none",i.is=function(e){return e instanceof Array?e.indexOf(this.current)>=0:this.current===e},i.can=function(e){return!this.transition&&(s[e].hasOwnProperty(this.current)||s[e].hasOwnProperty(d.WILDCARD))},i.cannot=function(e){return!this.can(e)},i.transitions=function(){return c[this.current]},i.isFinished=function(){return this.is(r)},i.error=e.error||function(e,t,n,r,i,o,a){throw a||o},n&&!n.defer&&i[n.event](),i},doCallback:function(e,t,n,r,i,o){if(t)try{return t.apply(e,[n,r,i].concat(o))}catch(t){return e.error(n,r,i,o,d.Error.INVALID_CALLBACK,"an exception occurred in a caller-provided callback function",t)}},beforeAnyEvent:function(e,t,n,r,i){return d.doCallback(e,e.onbeforeevent,t,n,r,i)},afterAnyEvent:function(e,t,n,r,i){return d.doCallback(e,e.onafterevent||e.onevent,t,n,r,i)},leaveAnyState:function(e,t,n,r,i){return d.doCallback(e,e.onleavestate,t,n,r,i)},enterAnyState:function(e,t,n,r,i){return d.doCallback(e,e.onenterstate||e.onstate,t,n,r,i)},changeState:function(e,t,n,r,i){return d.doCallback(e,e.onchangestate,t,n,r,i)},beforeThisEvent:function(e,t,n,r,i){return d.doCallback(e,e["onbefore"+t],t,n,r,i)},afterThisEvent:function(e,t,n,r,i){return d.doCallback(e,e["onafter"+t]||e["on"+t],t,n,r,i)},leaveThisState:function(e,t,n,r,i){return d.doCallback(e,e["onleave"+n],t,n,r,i)},enterThisState:function(e,t,n,r,i){return d.doCallback(e,e["onenter"+r]||e["on"+r],t,n,r,i)},beforeEvent:function(e,t,n,r,i){if(!1===d.beforeThisEvent(e,t,n,r,i)||!1===d.beforeAnyEvent(e,t,n,r,i))return!1},afterEvent:function(e,t,n,r,i){d.afterThisEvent(e,t,n,r,i),d.afterAnyEvent(e,t,n,r,i)},leaveState:function(e,t,n,r,i){var o=d.leaveThisState(e,t,n,r,i),a=d.leaveAnyState(e,t,n,r,i);return!1!==o&&!1!==a&&(d.ASYNC===o||d.ASYNC===a?d.ASYNC:void 0)},enterState:function(e,t,n,r,i){d.enterThisState(e,t,n,r,i),d.enterAnyState(e,t,n,r,i)},buildEvent:function(e,t){return function(){var n=this.current,r=t[n]||t[d.WILDCARD]||n,i=Array.prototype.slice.call(arguments);if(this.transition)return this.error(e,n,r,i,d.Error.PENDING_TRANSITION,"event "+e+" inappropriate because previous transition did not complete");if(this.cannot(e))return this.error(e,n,r,i,d.Error.INVALID_TRANSITION,"event "+e+" inappropriate in current state "+this.current);if(!1===d.beforeEvent(this,e,n,r,i))return d.Result.CANCELLED;if(n===r)return d.afterEvent(this,e,n,r,i),d.Result.NOTRANSITION;var o=this;this.transition=function(){return o.transition=null,o.current=r,d.enterState(o,e,n,r,i),d.changeState(o,e,n,r,i),d.afterEvent(o,e,n,r,i),d.Result.SUCCEEDED},this.transition.cancel=function(){o.transition=null,d.afterEvent(o,e,n,r,i)};var a=d.leaveState(this,e,n,r,i);return!1===a?(this.transition=null,d.Result.CANCELLED):d.ASYNC===a?d.Result.PENDING:this.transition?this.transition():void 0}}};Math.PI;w.assets={sounds:{laserOne:{osc1_oct:6,osc1_det:0,osc1_detune:0,osc1_xenv:1,osc1_vol:192,osc1_waveform:3,osc2_oct:8,osc2_det:0,osc2_detune:0,osc2_xenv:1,osc2_vol:192,osc2_waveform:1,noise_fader:0,env_attack:0,env_sustain:0,env_release:7916,env_master:99,fx_filter:0,fx_freq:11025,fx_resonance:255,fx_delay_time:0,fx_delay_amt:0,fx_pan_freq:0,fx_pan_amt:0,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:4,lfo_amt:27,lfo_waveform:1}},song:{rowLen:5513,endPattern:2,songData:[{osc1_oct:7,osc1_det:0,osc1_detune:0,osc1_xenv:0,osc1_vol:192,osc1_waveform:1,osc2_oct:6,osc2_det:0,osc2_detune:9,osc2_xenv:0,osc2_vol:192,osc2_waveform:1,noise_fader:0,env_attack:137,env_sustain:2e3,env_release:4611,env_master:192,fx_filter:1,fx_freq:982,fx_resonance:89,fx_delay_time:6,fx_delay_amt:25,fx_pan_freq:6,fx_pan_amt:77,lfo_osc1_freq:0,lfo_fx_freq:1,lfo_freq:3,lfo_amt:69,lfo_waveform:0,p:[1],c:[{n:[135,0,0,0,147,0,0,145,0,0,147,0,0,142,0,0,135,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}]}],songLen:9},letters:{"-":[[,,,,0],[,,,,0],[1,1,1,1,1],[,,,,0],[,,,,0]],".":[[,,,,0],[,,,,0],[,,,,0],[,,,,0],[,,1,,0]],1:[[,1,1,,0],[,,1,,0],[,,1,,0],[,,1,,0],[1,1,1,1,1]],2:[[1,1,1,1,0],[,,,,1],[,1,1,1,0],[1,,,,0],[1,1,1,1,1]],3:[[1,1,1,1,0],[,,,,1],[,1,1,1,1],[,,,,1],[1,1,1,1,0]],4:[[1,,,1,0],[1,,,1,0],[1,1,1,1,1],[,,,1,0],[,,,1,0]],5:[[1,1,1,1,1],[1,,,,0],[1,1,1,1,0],[,,,,1],[1,1,1,1,0]],6:[[,1,1,1,0],[1,,,,0],[1,1,1,1,0],[1,,,,1],[,1,1,1,0]],7:[[1,1,1,1,1],[,,,,1],[,,,1,0],[,,1,,0],[,,1,,0]],8:[[,1,1,1,0],[1,,,,1],[,1,1,1,0],[1,,,,1],[,1,1,1,0]],9:[[,1,1,1,0],[1,,,,1],[,1,1,1,1],[,,,,1],[,1,1,1,0]],0:[[,1,1,1,0],[1,,,,1],[1,,,,1],[1,,,,1],[,1,1,1,0]],A:[[1,1,1,1,1],[1,,,,1],[1,1,1,1,1],[1,,,,1],[1,,,,1]],B:[[1,1,1,1,0],[1,,,1,0],[1,1,1,1,1],[1,,,,1],[1,1,1,1,1]],C:[[1,1,1,1,1],[1,,,,0],[1,,,,0],[1,,,,0],[1,1,1,1,1]],D:[[1,1,1,,0],[1,,,1,0],[1,,,,1],[1,,,,1],[1,1,1,1,1]],E:[[1,1,1,1,1],[1,,,,0],[1,1,1,,0],[1,,,,0],[1,1,1,1,1]],F:[[1,1,1,1,1],[1,,,,0],[1,1,1,,0],[1,,,,0],[1,,,,0]],G:[[1,1,1,1,1],[1,,,,0],[1,,1,1,1],[1,,,,1],[1,1,1,1,1]],H:[[1,,,,1],[1,,,,1],[1,1,1,1,1],[1,,,,1],[1,,,,1]],I:[[1,1,1,1,1],[,,1,,0],[,,1,,0],[,,1,,0],[1,1,1,1,1]],J:[[,,,,1],[,,,,1],[,,,,1],[1,,,,1],[1,1,1,1,1]],K:[[1,,,1,0],[1,,1,,0],[1,1,1,,0],[1,,,1,0],[1,,,,1]],L:[[1,,,,0],[1,,,,0],[1,,,,0],[1,,,,0],[1,1,1,1,1]],M:[[1,,,,1],[1,1,,1,1],[1,,1,,1],[1,,,,1],[1,,,,1]],N:[[1,,,,1],[1,1,,,1],[1,,1,,1],[1,,,1,1],[1,,,,1]],O:[[1,1,1,1,1],[1,,,,1],[1,,,,1],[1,,,,1],[1,1,1,1,1]],P:[[1,1,1,1,1],[1,,,,1],[1,1,1,1,1],[1,,,,0],[1,,,,0]],Q:[[1,1,1,1,0],[1,,,1,0],[1,,,1,0],[1,,,1,0],[1,1,1,1,1]],R:[[1,1,1,1,1],[1,,,,1],[1,1,1,1,1],[1,,,1,0],[1,,,,1]],S:[[1,1,1,1,1],[1,,,,0],[1,1,1,1,1],[,,,,1],[1,1,1,1,1]],T:[[1,1,1,1,1],[,,1,,0],[,,1,,0],[,,1,,0],[,,1,,0]],U:[[1,,,,1],[1,,,,1],[1,,,,1],[1,,,,1],[1,1,1,1,1]],V:[[1,,,,1],[1,,,,1],[1,,,,1],[,1,,1,0],[,,1,,0]],W:[[1,,,,1],[1,,,,1],[1,,1,,1],[1,1,,1,1],[1,,,,1]],X:[[1,,,,1],[,1,,1,0],[,,1,,0],[,1,,1,0],[1,,,,1]],Y:[[1,,,,1],[1,,,,1],[1,1,1,1,1],[,,1,,0],[,,1,,0]],Z:[[1,1,1,1,1],[,,,1,0],[,,1,,0],[,1,,,0],[1,1,1,1,1]]," ":[[,,,,0],[,,,,0],[,,,,0],[,,,,0],[,,,,0]],",":[[,,,,0],[,,,,0],[,,,,0],[,,1,,0],[,,1,,0]],"+":[[,,,,0],[,,1,,0],[,1,1,1,0],[,,1,,0],[,,,,0]],"/":[[,,,,1],[,,,1,0],[,,1,,0],[,1,,,0],[1,,,,0]],":":[[,,,,0],[,,1,,0],[,,,,0],[,,1,,0],[,,,,0]],"@":[[1,1,1,1,1],[,,,,1],[1,1,1,,1],[1,,1,,1],[1,1,1,1,1]],x:[[1,,1,,1],[,1,,1,0],[1,,1,,1],[,1,,1,0],[1,,1,,1]],z:[[,1,,1,0],[1,,1,,1],[,1,,1,0],[1,,1,,1],[,1,,1,0]],o:[[1,1,1,1,1],[1,,,,1],[1,,1,,1],[1,,,,1],[1,1,1,1,1]],e:[[1,,,,0],[1,1,,,0],[1,1,1,,0],[1,1,1,1,0],[1,1,1,1,1]],w:[[,,,,1],[,,,1,1],[,,1,1,1],[,1,1,1,1],[1,1,1,1,1]],s:[[1,1,1,1,1],[,1,1,1,1],[,,1,1,1],[,,,1,1],[,,,,1]],d:[[1,1,1,1,1],[1,1,1,1,0],[1,1,1,,0],[1,1,,,0],[1,,,,0]],t:[[0,0,0,1,1],[0,0,1,1,1],[0,0,1,1,1],[0,0,1,1,1],[0,0,1,1,1]],y:[[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1]],u:[[1,1,0,0,0],[1,1,1,0,0],[0,0,1,0,0],[0,1,1,0,0],[1,1,1,0,0]],g:[[0,0,1,1,1],[0,0,0,1,1],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,1]],h:[[1,1,1,1,1],[1,1,1,1,1],[0,1,1,1,0],[1,1,1,1,1],[1,1,1,1,1]],j:[[1,1,1,0,0],[1,1,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[1,1,1,1,1]],b:[[0,0,0,1,1],[0,0,0,1,1],[0,0,0,0,1],[0,0,0,0,1],[0,0,0,0,1]],n:[[1,1,1,1,1],[1,1,1,1,1],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0]],a:[[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1]]}};var v={},p=2,g=33,m=null,y=[o,a,s,c];v.AudioGenerator=function(e){this.mixBuf=e,this.waveSize=e.length/p/2},v.AudioGenerator.prototype.getWave=function(){var e,t,n,r,i,o,a,s=this.mixBuf,c=this.waveSize*p*2;for(o=(i=c-8)-36,r=String.fromCharCode(82,73,70,70,255&i,i>>8&255,i>>16&255,i>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&o,o>>8&255,o>>16&255,o>>24&255),e=0;c>e;){for(n="",t=0;256>t&&c>e;++t,e+=2)a=-32768>(a=4*(s[e]+(s[e+1]<<8)-32768))?-32768:a>32767?32767:a,n+=String.fromCharCode(255&a,a>>8&255);r+=n}return r},v.AudioGenerator.prototype.getAudio=function(){var e=this.getWave(),t=new Audio("data:audio/wav;base64,"+btoa(e));return t.preload="none",t.load(),t},v.AudioGenerator.prototype.getAudioBuffer=function(e){null===m&&(m=new AudioContext);var t=this.mixBuf,n=this.waveSize*p*2,r=m.createBuffer(p,this.waveSize,44100),i=r.getChannelData(0),o=r.getChannelData(1),a=0,s=function(){for(var c=new Date,u=0;n/2>a;){var f=4*(t[4*a]+(t[4*a+1]<<8)-32768);if(f=-32768>f?-32768:f>32767?32767:f,i[a]=f/32768,f=4*(t[4*a+2]+(t[4*a+3]<<8)-32768),f=-32768>f?-32768:f>32767?32767:f,o[a]=f/32768,a+=1,(u+=1)%1e3==0&&new Date-c>g)return void setTimeout(s,0)}setTimeout(function(){e(r)},0)};setTimeout(s,0)},v.SoundGenerator=function(e,t){this.instr=e,this.rowLen=t||5605,this.osc_lfo=y[e.lfo_waveform],this.osc1=y[e.osc1_waveform],this.osc2=y[e.osc2_waveform],this.attack=e.env_attack,this.sustain=e.env_sustain,this.release=e.env_release,this.panFreq=Math.pow(2,e.fx_pan_freq-8)/this.rowLen,this.lfoFreq=Math.pow(2,e.lfo_freq-8)/this.rowLen},v.SoundGenerator.prototype.genSound=function(e,t,n){new Date;for(var r=0,i=0,a=u(e+12*(this.instr.osc1_oct-8)+this.instr.osc1_det)*(1+8e-4*this.instr.osc1_detune),s=u(e+12*(this.instr.osc2_oct-8)+this.instr.osc2_det)*(1+8e-4*this.instr.osc2_detune),c=this.instr.fx_resonance/255,f=0,l=0,h=this.attack+this.sustain+this.release-1;h>=0;--h){var d=h+n,v=this.osc_lfo(d*this.lfoFreq)*this.instr.lfo_amt/512+.5,p=1;h<this.attack?p=h/this.attack:h<this.attack+this.sustain||(p-=(h-this.attack-this.sustain)/this.release);var g=a;this.instr.lfo_osc1_freq&&(g+=v),this.instr.osc1_xenv&&(g*=p*p),r+=g;var m=this.osc1(r)*this.instr.osc1_vol;g=s,this.instr.osc2_xenv&&(g*=p*p),i+=g,m+=this.osc2(i)*this.instr.osc2_vol,this.instr.noise_fader&&(m+=(2*Math.random()-1)*this.instr.noise_fader*p),m*=p/255;var y=this.instr.fx_freq;this.instr.lfo_fx_freq&&(y*=v);var x=c*(m-l)-(f+=(y=1.5*Math.sin(3.141592*y/44100))*l);switch(l+=y*x,this.instr.fx_filter){case 1:m=x;break;case 2:m=f;break;case 3:m=l;break;case 4:m=f+x}if(g=o(d*this.panFreq)*this.instr.fx_pan_amt/512+.5,m*=39*this.instr.env_master,(d*=4)+3<t.length){var w=t[d]+(t[d+1]<<8)+m*(1-g);t[d]=255&w,t[d+1]=w>>8&255,w=t[d+2]+(t[d+3]<<8)+m*g,t[d+2]=255&w,t[d+3]=w>>8&255}}},v.SoundGenerator.prototype.getAudioGenerator=function(e,t){var n=this.attack+this.sustain+this.release-1+32*this.rowLen,r=this;f(n,function(i){r.genSound(e,i,0),l(i,n,r.instr,r.rowLen,function(){t(new v.AudioGenerator(i))})})},v.SoundGenerator.prototype.createAudio=function(e,t){this.getAudioGenerator(e,function(e){t(e.getAudio())})},v.SoundGenerator.prototype.createAudioBuffer=function(e,t){this.getAudioGenerator(e,function(e){e.getAudioBuffer(t)})},v.MusicGenerator=function(e){this.song=e,this.waveSize=44100*e.songLen},v.MusicGenerator.prototype.generateTrack=function(e,t,n){var r=this;f(this.waveSize,function(i){var o=r.waveSize,a=r.waveSize*p*2,s=r.song.rowLen,c=r.song.endPattern,u=new v.SoundGenerator(e,s),f=0,h=0,d=0,m=function(){for(var t=new Date;;)if(32!==d){if(h===c-1)return void setTimeout(y,0);var n=e.p[h];if(n){var r=e.c[n-1].n[d];r&&u.genSound(r,i,f)}if(f+=s,d+=1,new Date-t>g)return void setTimeout(m,0)}else d=0,h+=1},y=function(){l(i,o,e,s,w)},x=0,w=function(){for(var e=new Date,r=0;a>x;){var o=t[x]+(t[x+1]<<8)+i[x]+(i[x+1]<<8)-32768;if(t[x]=255&o,t[x+1]=o>>8&255,x+=2,(r+=1)%1e3==0&&new Date-e>g)return void setTimeout(w,0)}setTimeout(n,0)};setTimeout(m,0)})},v.MusicGenerator.prototype.getAudioGenerator=function(e){var t=this;f(this.waveSize,function(n){var r=0,i=function(){r<t.song.songData.length?(r+=1,t.generateTrack(t.song.songData[r-1],n,i)):e(new v.AudioGenerator(n))};i()})},v.MusicGenerator.prototype.createAudio=function(e){this.getAudioGenerator(function(t){e(t.getAudio())})},v.MusicGenerator.prototype.createAudioBuffer=function(e){this.getAudioGenerator(function(t){t.getAudioBuffer(e)})};var x=function(){function e(e){return r.appendChild(e.dom),e}function t(e){for(var t=0;t<r.children.length;t++)r.children[t].style.display=t===e?"block":"none";n=e}var n=0,r=document.createElement("div");r.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",r.addEventListener("click",function(e){e.preventDefault(),t(++n%r.children.length)},!1);var i=(performance||Date).now(),o=i,a=0,s=e(new x.Panel("FPS","#0ff","#002")),c=e(new x.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var u=e(new x.Panel("MB","#f08","#201"));return t(0),{REVISION:16,dom:r,addPanel:e,showPanel:t,begin:function(){i=(performance||Date).now()},end:function(){a++;var e=(performance||Date).now();if(c.update(e-i,200),e>o+1e3&&(s.update(1e3*a/(e-o),100),o=e,a=0,u)){var t=performance.memory;u.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){i=this.end()},domElement:r,setMode:t}};x.Panel=function(e,t,n){var r=1/0,i=0,o=Math.round,a=o(window.devicePixelRatio||1),s=80*a,c=48*a,u=3*a,f=2*a,l=3*a,h=15*a,d=74*a,v=30*a,p=document.createElement("canvas");p.width=s,p.height=c,p.style.cssText="width:80px;height:48px";var g=p.getContext("2d");return g.font="bold "+9*a+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=n,g.fillRect(0,0,s,c),g.fillStyle=t,g.fillText(e,u,f),g.fillRect(l,h,d,v),g.fillStyle=n,g.globalAlpha=.9,g.fillRect(l,h,d,v),{dom:p,update:function(c,m){r=Math.min(r,c),i=Math.max(i,c),g.fillStyle=n,g.globalAlpha=1,g.fillRect(0,0,s,h),g.fillStyle=t,g.fillText(o(c)+" "+e+" ("+o(r)+"-"+o(i)+")",u,f),g.drawImage(p,l+a,h,d-a,v,l,h,d-a,v),g.fillRect(l+d-a,h,a,v),g.fillStyle=n,g.globalAlpha=.9,g.fillRect(l+d-a,h,a,o((1-c/m)*v))}}},"object"==typeof module&&(module.exports=x),Key={_pressed:{},_released:{},LEFT:37,UP:38,RIGHT:39,DOWN:40,SPACE:32,a:65,w:87,s:83,d:68,z:90,x:88,f:70,p:80,r:82,isDown:function(e){return this._pressed[e]},justReleased:function(e){return this._released[e]},onKeydown:function(e){this._pressed[e.keyCode]=!0},onKeyup:function(e){this._released[e.keyCode]=!0,delete this._pressed[e.keyCode]},update:function(){this._released={}}},Txt={textLine:function(e){for(var t=e.text.length,n=0;t>n;n++)for(var r=w.assets.letters[e.text.charAt(n)]||w.assets.letters.unknown,i=0;5>i;i++)for(var o=0;5>o;o++)1===r[i][o]&&(1===e.scale?w.gfx.pset(e.x+o*e.scale+(5*e.scale+e.hspacing)*n,e.y+i*e.scale,e.color):w.gfx.fr(e.x+o*e.scale+(5*e.scale+e.hspacing)*n,e.y+i*e.scale,e.x+o*e.scale+(5*e.scale+e.hspacing)*n+e.scale,e.y+i*e.scale+e.scale,e.color))},text:function(e){var t=5*e.scale,n=e.text.split("\n"),r=n.slice(0),i=n.length,o=r.sort(function(e,t){return t.length-e.length})[0],a=o.length*t+(o.length-1)*e.hspacing,s=i*t+(i-1)*e.vspacing;e.halign||(e.halign="left"),e.valign||(e.valign="bottom");var c=e.x,u=e.y,f=e.x+a,l=e.y+s;"center"==e.halign?(c=e.x-a/2,f=e.x+a/2):"right"==e.halign&&(c=e.x-a,f=e.x),"center"==e.valign?(u=e.y-s/2,l=e.y+s/2):"bottom"==e.valign&&(u=e.y-s,l=e.y);var h=c+a/2,d=u+s/2;if(e.render)for(var v=0;i>v;v++){var p=n[v],g=p.length*t+(p.length-1)*e.hspacing,m=e.x,y=e.y+(t+e.vspacing)*v;"center"==e.halign?m=e.x-g/2:"right"==e.halign&&(m=e.x-g),"center"==e.valign?y-=s/2:"bottom"==e.valign&&(y-=s),e.snap&&(m=Math.floor(m),y=Math.floor(y)),this.textLine({ctx:e.ctx,x:m,y:y,text:p,hspacing:e.hspacing||0,scale:e.scale||1,color:e.color})}return{sx:c,sy:u,cx:h,cy:d,ex:f,ey:l,width:a,height:s}}},h.boot={onenter:function(e,t,n){w.sounds={},m&&m.close(),window.AudioContext=window.AudioContext||window.webkitAudioContext,m||(m=new AudioContext),new v.MusicGenerator(w.assets.song).createAudioBuffer(function(e){w.sounds.song=e}),w.t=0,w.moveX=0,w.speedFactor=.6,w.songTrigger=!1},onexit:function(e,t,n){},step:function(e){Key.isDown(Key.p)&&"boot"==fsm.current&&fsm.ready()},render:function(e){w.gfx.fr(0,0,256,256,0),w.gfx.fr(0,0,64,64,2),Txt.text({x:128,y:40+15*Math.sin(2.5*w.t),text:"BOOT",hspacing:8+4*Math.cos(2.9*w.t),vspacing:15+5*Math.sin(3.5*w.t),halign:"center",valign:"top",scale:10,snap:1,render:1,color:21})}},h.gameover={onenter:function(e,t,n){},onexit:function(e,t,n){},step:function(e){Key.isDown(Key.r)&&fsm.reset()},render:function(e){w.gfx.fr(0,0,256,256,0),w.gfx.fr(0,0,64,64,2),Txt.text({x:128,y:40+15*Math.sin(2.5*w.t),text:"GAME\nOVER",hspacing:8+4*Math.cos(2.9*w.t),vspacing:15+5*Math.sin(3.5*w.t),halign:"center",valign:"top",scale:10,snap:1,render:1,color:21})}},h.menu={onenter:function(e,t,n){},onexit:function(e,t,n){},step:function(e){Key.isDown(Key.r)&&fsm.play()},render:function(e){w.gfx.fr(0,0,256,256,0),w.gfx.fr(0,0,64,64,2),Txt.text({x:128,y:40+15*Math.sin(2.5*w.t),text:"MENU",hspacing:8+4*Math.cos(2.9*w.t),vspacing:15+5*Math.sin(3.5*w.t),halign:"center",valign:"top",scale:10,snap:1,render:1,color:21})}},h.game={onenter:function(){w.sounds={},window.AudioContext=window.AudioContext||window.webkitAudioContext,m=new AudioContext,new v.MusicGenerator(w.assets.song).createAudioBuffer(function(e){w.sounds.song=e}),bulletPool=new r(100,i),bulletPool.init(),w.songTrigger=!1,w.player.init()},onexit:function(e,t,n){},step:function(e){w.cos=Math.cos(e),w.sin=Math.sin(e),w.player.update(e),Key.isDown(Key.z)&&(w.songTrigger=!0),w.songTrigger&&(w.songTrigger=!1,w.playSound(w.sounds.song,1,1,0)),bulletPool.use()},render:function(e){w.renderTarget=0,w.gfx.clear(1),w.gfx.checker(256,256,16,16,2);for(var t=0;32>t;t++)Txt.text({x:3+16*t,y:45+t%4*16,text:""+t,scale:1,snap:1,hspacing:2,vspacing:2,halign:"left",valign:"bottom",render:1,color:t});w.player.draw(),Txt.text({x:8,y:240,text:"X: "+(""+w.player.x).substring(0,7)+"\nY: "+(""+w.player.y).substring(0,7),hspacing:2,vspacing:2,halign:"left",valign:"top",scale:1,snap:1,render:1,color:21})}},w.player={bullet:{x:0,y:0,xvel:0,yvel:0},init:function(){this.x=64,this.y=230,this.radius=12,this.xvel=0,this.yvel=0,this.xspeed=400,this.yspeed=400,this.drag=.6},update:function(e){w.player.bullet.x=w.player.x,w.player.bullet.y=w.player.y,w.player.xvel*=w.player.drag,w.player.yvel*=w.player.drag;let t=e*w.player.xvel,n=e*w.player.yvel;w.player.x+=t,w.player.y+=n,(Key.isDown(Key.d)||Key.isDown(Key.RIGHT))&&(w.player.xvel=w.player.xspeed),(Key.isDown(Key.a)||Key.isDown(Key.LEFT))&&(w.player.xvel=-w.player.xspeed),(Key.isDown(Key.w)||Key.isDown(Key.UP))&&(w.player.yvel=-w.player.yspeed),(Key.isDown(Key.s)||Key.isDown(Key.DOWN))&&(w.player.yvel=w.player.yspeed),Key.isDown(Key.SPACE||Key.isDown(Key.z))&&(w.player.bullet.yvel=-350,bulletPool.get(w.player.bullet)),w.player.x>256&&(w.player.x=0),0>w.player.x&&(w.player.x=256),w.player.y>256&&(w.player.y=0),0>w.player.y&&(fsm.lose(),w.player.y=256)},draw:function(e){w.gfx.fillCircle(this.x,this.y,this.radius,21)}};var w=ENGINE;init=function(){w.last=0,w.dt=0,w.now=0,w.t=0,stats=new x,document.body.appendChild(stats.dom),w.canvasInit(),fsm=d.create({initial:"init",events:[{name:"load",from:"init",to:"boot"},{name:"ready",from:"boot",to:"game"},{name:"play",from:["menu","gameover"],to:"game"},{name:"lose",from:["game","gameover"],to:"gameover"},{name:"reset",from:["init","boot","menu","gameover","game"],to:"boot"}],callbacks:{onenterboot:function(e,t,n){h.boot.onenter(e,t,n)},onentermenu:function(e,t,n){h.menu.onenter(e,t,n)},onleavemenu:function(e,t,n){h.menu.onexit(e,t,n)},onentergame:function(e,t,n){h.game.onenter(e,t,n)},onleavegame:function(e,t,n){h.game.onexit(e,t,n)},onentergameover:function(e,t,n){h.gameover.onenter(e,t,n)}}}),window.addEventListener("keyup",function(e){Key.onKeyup(e)},!1),window.addEventListener("mousedown",function(e){stopCapture(e)},!1),window.addEventListener("keydown",function(e){Key.onKeydown(e)},!1),window.addEventListener("blur",function(e){paused=!0},!1),window.addEventListener("focus",function(e){paused=!1},!1),window.addEventListener("resize",function(){w.canvas.width=window.innerWidth,w.canvas.height=window.innerHeight}),fsm.load(),loop()},stopCapture=function(e){w.capturer.stop(),w.capturer.save()},loop=function(){stats.begin();let e=(new Date).getTime();w.dt=Math.min(1,(e-w.last)/1e3),w.t+=w.dt,h[fsm.current].render(),h[fsm.current].step(w.dt),w.last=e,w.render(),stats.end(),requestAnimationFrame(loop)},window.onload=init()}();
</script></body></html>