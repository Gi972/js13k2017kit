<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Game Zero ES6</title><style>
body{margin:0;overflow:hidden;background:#111;color:#ccc}#canvas{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%;image-rendering:optimizeSpeed;image-rendering:-moz-crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:-o-crisp-edges;image-rendering:pixelated;-ms-interpolation-mode:nearest-neighbor;cursor:none;margin:auto}
</style></head><body><canvas id="canvas"></canvas><script>
var GAME=function(){function e(e){M.fill(e,A,A+65536)}function n(e,t,n){t|=0,(e|=0)>-1&&256>e&&t>-1&&256>t&&(M[A+(256*t+e)]=n)}function i(e,t,i,o,s){var r,a,u=(o|=0)-(t|=0),c=(i|=0)-(e|=0);if(0>u?(u=-u,a=-1):a=1,0>c?(c=-c,r=-1):r=1,u<<=1,c<<=1,n(e,t,s),c>u)for(var f=u-(c>>1);e!=i;)0>f||(t+=a,f-=c),f+=u,n(e+=r,t,s);else for(f=c-(u>>1);t!=o;)0>f||(e+=r,f-=u),f+=c,n(e,t+=a,s)}function o(e,t,i,o){var s=-i,r=0,a=2-2*i;do{n(e-s,t+r,o),n(e-r,t-s,o),n(e+s,t-r,o),n(e+r,t+s,o),(i=a)>r||(a+=2*++r+1),(i>s||a>r)&&(a+=2*++s+1)}while(0>s)}function s(e,t,n,o){e|=0,t|=0,o|=0;var s=-(n|=0),r=0,a=2-2*n;do{i(e-s,t-r,e+s,t-r,o),i(e-s,t+r,e+s,t+r,o),(n=a)>r||(a+=2*++r+1),(n>s||a>r)&&(a+=2*++s+1)}while(0>s)}function r(e,t,n,o,s){x1=0|e,y1=0|t,x2=e+n|0,y2=t+o|0;var r=Math.abs(y2-y1);if(i(x1,y1,x2,y1,s),r>0)for(;--r;)i(x1,y1+r,x2,y1+r,s);i(x1,y2,x2,y2,s)}function a(){for(var e=65536;e--;)b[e]=S[D[M[e]]];K.data.set(T),m.putImageData(K,0,0),compositeSize=window.innerWidth<window.innerHeight?window.innerWidth:window.innerHeight,compositeOrigin=(window.innerWidth-compositeSize)/2|0,_.imageSmoothingEnabled=!1,_.mozImageSmoothingEnabled=!1,_.drawImage(x,0,0,255,255,compositeOrigin,0,compositeSize,compositeSize)}function u(e,t){var n=e,i=[];this.init=function(){for(var e=0;n>e;e++){var o=new t;o.init(),i[e]=o}},this.get=function(e){if(!i[n-1].inUse)return i[n-1].spawn(e),i.unshift(i.pop()),i[n-1]},this.getPool=function(){return i},this.use=function(){for(var e=0;n>e&&i[e].inUse;e++)i[e].use(dt)&&(i[e].clear(),i.push(i.splice(e,1)[0]))}}function c(){this.inUse=!1,this.init=function(){this.x=-500,this.y=-500,this.dead=!0,this.xvel=0,this.yvel=1,this.life=1},c.prototype.spawn=function(e){this.x=e.x,this.y=e.y,this.xvel=e.xvel,this.yvel=e.yvel,this.inUse=!0,this.life=e.life||1,this.remaining=e.life||1,this.radius=e.radius||1,this.color=e.color||21,this.dead=!1},c.prototype.use=function(e){return!!this.dead||(this.remaining-=e,this.x+=e*this.xvel,this.y+=e*this.yvel,this.draw(),this.remaining>0?(0>this.y&&(this.dead=!0),!1):(this.dead=!0,!0))},c.prototype.clear=function(){this.x=-500,this.y=-500,this.dead=!0,this.xvel=0,this.yvel=0,this.life=1,this.inUse=!1},c.prototype.draw=function(){o(this.x,this.y,0|4*Math.random(),21)}}function f(e){return Math.sin(6.283184*e)}function l(e){return 0>f(e)?-1:1}function h(e){return e%1-.5}function d(e){var t=e%1*4;return 2>t?t-1:3-t}function v(e){return.00390625*Math.pow(1.059463094,e-128)}function y(e,t){setTimeout(function(){var n=new Uint8Array(e*C*2),i=n.length-2,o=function(){for(var e=new Date,s=0;i>=0;)if(n[i]=0,n[i+1]=128,i-=2,(s+=1)%1e3==0&&new Date-e>E)return void setTimeout(o,0);setTimeout(function(){t(n)},0)};setTimeout(o,0)},0)}function p(e,t,n,i,o){var s=n.fx_delay_time*i>>1,r=n.fx_delay_amt/255,a=0,u=function(){for(var n=new Date,i=0;t-s>a;){var c=4*a,f=4*(a+s),l=e[f]+(e[f+1]<<8)+(e[c+2]+(e[c+3]<<8)-32768)*r;if(e[f]=255&l,e[f+1]=l>>8&255,l=e[f+2]+(e[f+3]<<8)+(e[c]+(e[c+1]<<8)-32768)*r,e[f+2]=255&l,e[f+3]=l>>8&255,++a,(i+=1)%1e3==0&&new Date-n>E)return void setTimeout(u,0)}setTimeout(o,0)};setTimeout(u,0)}var g={},w=document.getElementById("canvas"),_=canvas.getContext("2d"),x=document.createElement("canvas"),m=x.getContext("2d"),A=0,S=[4278190080,4281606178,4282132549,4281416038,4282078863,4280709599,4284915929,4288332782,4281791227,4283491737,4281384554,4285436983,4281297227,4280568658,4281941042,4285808447,4286734384,4292963931,4294941539,4293184863,4294761419,4294967295,4290227611,4287069828,4285164137,4283586137,4287251062,4281479852,4284700633,4290411479,4283078543,4281364362],D=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31];w.width=window.innerWidth,w.height=window.innerHeight,_.imageSmoothingEnabled=!1,_.mozImageSmoothingEnabled=!1,x.width=x.height=256;var K=m.getImageData(0,0,256,256),G=new ArrayBuffer(K.data.length),T=new Uint8Array(G),b=new Uint32Array(G),M=new Uint8ClampedArray(524288);playSound=function(e,t,n,i){var o=q.createBufferSource(),s=q.createGain(),r=q.createStereoPanner();return o.buffer=e,o.connect(r),r.connect(s),s.connect(q.destination),o.playbackRate.value=t,o.loop=i,s.gain.value=1,r.pan.value=n,o.start(),{volume:s,sound:o}},assets={sounds:{laserOne:{osc1_oct:6,osc1_det:0,osc1_detune:0,osc1_xenv:1,osc1_vol:192,osc1_waveform:3,osc2_oct:8,osc2_det:0,osc2_detune:0,osc2_xenv:1,osc2_vol:192,osc2_waveform:1,noise_fader:0,env_attack:0,env_sustain:0,env_release:7916,env_master:99,fx_filter:0,fx_freq:11025,fx_resonance:255,fx_delay_time:0,fx_delay_amt:0,fx_pan_freq:0,fx_pan_amt:0,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:4,lfo_amt:27,lfo_waveform:1}},song:{rowLen:5513,endPattern:2,songData:[{osc1_oct:7,osc1_det:0,osc1_detune:0,osc1_xenv:0,osc1_vol:192,osc1_waveform:1,osc2_oct:6,osc2_det:0,osc2_detune:9,osc2_xenv:0,osc2_vol:192,osc2_waveform:1,noise_fader:0,env_attack:137,env_sustain:2e3,env_release:4611,env_master:192,fx_filter:1,fx_freq:982,fx_resonance:89,fx_delay_time:6,fx_delay_amt:25,fx_pan_freq:6,fx_pan_amt:77,lfo_osc1_freq:0,lfo_fx_freq:1,lfo_freq:3,lfo_amt:69,lfo_waveform:0,p:[1],c:[{n:[135,0,0,0,147,0,0,145,0,0,147,0,0,142,0,0,135,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}]}],songLen:9},letters:{"-":[[,,,,0],[,,,,0],[1,1,1,1,1],[,,,,0],[,,,,0]],".":[[,,,,0],[,,,,0],[,,,,0],[,,,,0],[,,1,,0]],1:[[,1,1,,0],[,,1,,0],[,,1,,0],[,,1,,0],[1,1,1,1,1]],2:[[1,1,1,1,0],[,,,,1],[,1,1,1,0],[1,,,,0],[1,1,1,1,1]],3:[[1,1,1,1,0],[,,,,1],[,1,1,1,1],[,,,,1],[1,1,1,1,0]],4:[[1,,,1,0],[1,,,1,0],[1,1,1,1,1],[,,,1,0],[,,,1,0]],5:[[1,1,1,1,1],[1,,,,0],[1,1,1,1,0],[,,,,1],[1,1,1,1,0]],6:[[,1,1,1,0],[1,,,,0],[1,1,1,1,0],[1,,,,1],[,1,1,1,0]],7:[[1,1,1,1,1],[,,,,1],[,,,1,0],[,,1,,0],[,,1,,0]],8:[[,1,1,1,0],[1,,,,1],[,1,1,1,0],[1,,,,1],[,1,1,1,0]],9:[[,1,1,1,0],[1,,,,1],[,1,1,1,1],[,,,,1],[,1,1,1,0]],0:[[,1,1,1,0],[1,,,,1],[1,,,,1],[1,,,,1],[,1,1,1,0]],A:[[1,1,1,1,1],[1,,,,1],[1,1,1,1,1],[1,,,,1],[1,,,,1]],B:[[1,1,1,1,0],[1,,,1,0],[1,1,1,1,1],[1,,,,1],[1,1,1,1,1]],C:[[1,1,1,1,1],[1,,,,0],[1,,,,0],[1,,,,0],[1,1,1,1,1]],D:[[1,1,1,,0],[1,,,1,0],[1,,,,1],[1,,,,1],[1,1,1,1,1]],E:[[1,1,1,1,1],[1,,,,0],[1,1,1,,0],[1,,,,0],[1,1,1,1,1]],F:[[1,1,1,1,1],[1,,,,0],[1,1,1,,0],[1,,,,0],[1,,,,0]],G:[[1,1,1,1,1],[1,,,,0],[1,,1,1,1],[1,,,,1],[1,1,1,1,1]],H:[[1,,,,1],[1,,,,1],[1,1,1,1,1],[1,,,,1],[1,,,,1]],I:[[1,1,1,1,1],[,,1,,0],[,,1,,0],[,,1,,0],[1,1,1,1,1]],J:[[,,,,1],[,,,,1],[,,,,1],[1,,,,1],[1,1,1,1,1]],K:[[1,,,1,0],[1,,1,,0],[1,1,1,,0],[1,,,1,0],[1,,,,1]],L:[[1,,,,0],[1,,,,0],[1,,,,0],[1,,,,0],[1,1,1,1,1]],M:[[1,,,,1],[1,1,,1,1],[1,,1,,1],[1,,,,1],[1,,,,1]],N:[[1,,,,1],[1,1,,,1],[1,,1,,1],[1,,,1,1],[1,,,,1]],O:[[1,1,1,1,1],[1,,,,1],[1,,,,1],[1,,,,1],[1,1,1,1,1]],P:[[1,1,1,1,1],[1,,,,1],[1,1,1,1,1],[1,,,,0],[1,,,,0]],Q:[[1,1,1,1,0],[1,,,1,0],[1,,,1,0],[1,,,1,0],[1,1,1,1,1]],R:[[1,1,1,1,1],[1,,,,1],[1,1,1,1,1],[1,,,1,0],[1,,,,1]],S:[[1,1,1,1,1],[1,,,,0],[1,1,1,1,1],[,,,,1],[1,1,1,1,1]],T:[[1,1,1,1,1],[,,1,,0],[,,1,,0],[,,1,,0],[,,1,,0]],U:[[1,,,,1],[1,,,,1],[1,,,,1],[1,,,,1],[1,1,1,1,1]],V:[[1,,,,1],[1,,,,1],[1,,,,1],[,1,,1,0],[,,1,,0]],W:[[1,,,,1],[1,,,,1],[1,,1,,1],[1,1,,1,1],[1,,,,1]],X:[[1,,,,1],[,1,,1,0],[,,1,,0],[,1,,1,0],[1,,,,1]],Y:[[1,,,,1],[1,,,,1],[1,1,1,1,1],[,,1,,0],[,,1,,0]],Z:[[1,1,1,1,1],[,,,1,0],[,,1,,0],[,1,,,0],[1,1,1,1,1]]," ":[[,,,,0],[,,,,0],[,,,,0],[,,,,0],[,,,,0]],",":[[,,,,0],[,,,,0],[,,,,0],[,,1,,0],[,,1,,0]],"+":[[,,,,0],[,,1,,0],[,1,1,1,0],[,,1,,0],[,,,,0]],"/":[[,,,,1],[,,,1,0],[,,1,,0],[,1,,,0],[1,,,,0]],":":[[,,,,0],[,,1,,0],[,,,,0],[,,1,,0],[,,,,0]],"@":[[1,1,1,1,1],[,,,,1],[1,1,1,,1],[1,,1,,1],[1,1,1,1,1]],x:[[1,,1,,1],[,1,,1,0],[1,,1,,1],[,1,,1,0],[1,,1,,1]],z:[[,1,,1,0],[1,,1,,1],[,1,,1,0],[1,,1,,1],[,1,,1,0]],o:[[1,1,1,1,1],[1,,,,1],[1,,1,,1],[1,,,,1],[1,1,1,1,1]],e:[[1,,,,0],[1,1,,,0],[1,1,1,,0],[1,1,1,1,0],[1,1,1,1,1]],w:[[,,,,1],[,,,1,1],[,,1,1,1],[,1,1,1,1],[1,1,1,1,1]],s:[[1,1,1,1,1],[,1,1,1,1],[,,1,1,1],[,,,1,1],[,,,,1]],d:[[1,1,1,1,1],[1,1,1,1,0],[1,1,1,,0],[1,1,,,0],[1,,,,0]],t:[[0,0,0,1,1],[0,0,1,1,1],[0,0,1,1,1],[0,0,1,1,1],[0,0,1,1,1]],y:[[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1]],u:[[1,1,0,0,0],[1,1,1,0,0],[0,0,1,0,0],[0,1,1,0,0],[1,1,1,0,0]],g:[[0,0,1,1,1],[0,0,0,1,1],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,1]],h:[[1,1,1,1,1],[1,1,1,1,1],[0,1,1,1,0],[1,1,1,1,1],[1,1,1,1,1]],j:[[1,1,1,0,0],[1,1,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[1,1,1,1,1]],b:[[0,0,0,1,1],[0,0,0,1,1],[0,0,0,0,1],[0,0,0,0,1],[0,0,0,0,1]],n:[[1,1,1,1,1],[1,1,1,1,1],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0]],a:[[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1]]}};var k={},C=2,E=33,q=null,z=[f,l,h,d];k.AudioGenerator=function(e){this.mixBuf=e,this.waveSize=e.length/C/2},k.AudioGenerator.prototype.getWave=function(){var e,t,n,i,o,s,r,a=this.mixBuf,u=this.waveSize*C*2;for(s=(o=u-8)-36,i=String.fromCharCode(82,73,70,70,255&o,o>>8&255,o>>16&255,o>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&s,s>>8&255,s>>16&255,s>>24&255),e=0;u>e;){for(n="",t=0;256>t&&u>e;++t,e+=2)r=-32768>(r=4*(a[e]+(a[e+1]<<8)-32768))?-32768:r>32767?32767:r,n+=String.fromCharCode(255&r,r>>8&255);i+=n}return i},k.AudioGenerator.prototype.getAudio=function(){var e=this.getWave(),t=new Audio("data:audio/wav;base64,"+btoa(e));return t.preload="none",t.load(),t},k.AudioGenerator.prototype.getAudioBuffer=function(e){null===q&&(q=new AudioContext);var t=this.mixBuf,n=this.waveSize*C*2,i=q.createBuffer(C,this.waveSize,44100),o=i.getChannelData(0),s=i.getChannelData(1),r=0,a=function(){for(var u=new Date,c=0;n/2>r;){var f=4*(t[4*r]+(t[4*r+1]<<8)-32768);if(f=-32768>f?-32768:f>32767?32767:f,o[r]=f/32768,f=4*(t[4*r+2]+(t[4*r+3]<<8)-32768),f=-32768>f?-32768:f>32767?32767:f,s[r]=f/32768,r+=1,(c+=1)%1e3==0&&new Date-u>E)return void setTimeout(a,0)}setTimeout(function(){e(i)},0)};setTimeout(a,0)},k.SoundGenerator=function(e,t){this.instr=e,this.rowLen=t||5605,this.osc_lfo=z[e.lfo_waveform],this.osc1=z[e.osc1_waveform],this.osc2=z[e.osc2_waveform],this.attack=e.env_attack,this.sustain=e.env_sustain,this.release=e.env_release,this.panFreq=Math.pow(2,e.fx_pan_freq-8)/this.rowLen,this.lfoFreq=Math.pow(2,e.lfo_freq-8)/this.rowLen},k.SoundGenerator.prototype.genSound=function(e,t,n){new Date;for(var i=0,o=0,s=v(e+12*(this.instr.osc1_oct-8)+this.instr.osc1_det)*(1+8e-4*this.instr.osc1_detune),r=v(e+12*(this.instr.osc2_oct-8)+this.instr.osc2_det)*(1+8e-4*this.instr.osc2_detune),a=this.instr.fx_resonance/255,u=0,c=0,l=this.attack+this.sustain+this.release-1;l>=0;--l){var h=l+n,d=this.osc_lfo(h*this.lfoFreq)*this.instr.lfo_amt/512+.5,y=1;l<this.attack?y=l/this.attack:l<this.attack+this.sustain||(y-=(l-this.attack-this.sustain)/this.release);var p=s;this.instr.lfo_osc1_freq&&(p+=d),this.instr.osc1_xenv&&(p*=y*y),i+=p;var g=this.osc1(i)*this.instr.osc1_vol;p=r,this.instr.osc2_xenv&&(p*=y*y),o+=p,g+=this.osc2(o)*this.instr.osc2_vol,this.instr.noise_fader&&(g+=(2*Math.random()-1)*this.instr.noise_fader*y),g*=y/255;var w=this.instr.fx_freq;this.instr.lfo_fx_freq&&(w*=d);var _=a*(g-c)-(u+=(w=1.5*Math.sin(3.141592*w/44100))*c);switch(c+=w*_,this.instr.fx_filter){case 1:g=_;break;case 2:g=u;break;case 3:g=c;break;case 4:g=u+_}if(p=f(h*this.panFreq)*this.instr.fx_pan_amt/512+.5,g*=39*this.instr.env_master,(h*=4)+3<t.length){var x=t[h]+(t[h+1]<<8)+g*(1-p);t[h]=255&x,t[h+1]=x>>8&255,x=t[h+2]+(t[h+3]<<8)+g*p,t[h+2]=255&x,t[h+3]=x>>8&255}}},k.SoundGenerator.prototype.getAudioGenerator=function(e,t){var n=this.attack+this.sustain+this.release-1+32*this.rowLen,i=this;y(n,function(o){i.genSound(e,o,0),p(o,n,i.instr,i.rowLen,function(){t(new k.AudioGenerator(o))})})},k.SoundGenerator.prototype.createAudio=function(e,t){this.getAudioGenerator(e,function(e){t(e.getAudio())})},k.SoundGenerator.prototype.createAudioBuffer=function(e,t){this.getAudioGenerator(e,function(e){e.getAudioBuffer(t)})},k.MusicGenerator=function(e){this.song=e,this.waveSize=44100*e.songLen},k.MusicGenerator.prototype.generateTrack=function(e,t,n){var i=this;y(this.waveSize,function(o){var s=i.waveSize,r=i.waveSize*C*2,a=i.song.rowLen,u=i.song.endPattern,c=new k.SoundGenerator(e,a),f=0,l=0,h=0,d=function(){for(var t=new Date;;)if(32!==h){if(l===u-1)return void setTimeout(v,0);var n=e.p[l];if(n){var i=e.c[n-1].n[h];i&&c.genSound(i,o,f)}if(f+=a,h+=1,new Date-t>E)return void setTimeout(d,0)}else h=0,l+=1},v=function(){p(o,s,e,a,g)},y=0,g=function(){for(var e=new Date,i=0;r>y;){var s=t[y]+(t[y+1]<<8)+o[y]+(o[y+1]<<8)-32768;if(t[y]=255&s,t[y+1]=s>>8&255,y+=2,(i+=1)%1e3==0&&new Date-e>E)return void setTimeout(g,0)}setTimeout(n,0)};setTimeout(d,0)})},k.MusicGenerator.prototype.getAudioGenerator=function(e){var t=this;y(this.waveSize,function(n){var i=0,o=function(){i<t.song.songData.length?(i+=1,t.generateTrack(t.song.songData[i-1],n,o)):e(new k.AudioGenerator(n))};o()})},k.MusicGenerator.prototype.createAudio=function(e){this.getAudioGenerator(function(t){e(t.getAudio())})},k.MusicGenerator.prototype.createAudioBuffer=function(e){this.getAudioGenerator(function(t){t.getAudioBuffer(e)})},Key={_pressed:{},_released:{},LEFT:37,UP:38,RIGHT:39,DOWN:40,SPACE:32,a:65,w:87,s:83,d:68,z:90,x:88,f:70,p:80,r:82,isDown(e){return this._pressed[e]},justReleased(e){return this._released[e]},onKeydown(e){this._pressed[e.keyCode]=!0},onKeyup(e){this._released[e.keyCode]=!0,delete this._pressed[e.keyCode]},update(){this._released={}}},Txt={textLine(e){for(var t=e.text.length,i=0;t>i;i++)for(var o=assets.letters[e.text.charAt(i)]||assets.letters.unknown,s=0;5>s;s++)for(var a=0;5>a;a++)1===o[s][a]&&(1===e.scale?n(e.x+a*e.scale+(5*e.scale+e.hspacing)*i,e.y+s*e.scale,e.color):r(e.x+a*e.scale+(5*e.scale+e.hspacing)*i,e.y+s*e.scale,e.scale,e.scale,e.color))},text(e){var t=5*e.scale,n=e.text.split("\n"),i=n.slice(0),o=n.length,s=i.sort(function(e,t){return t.length-e.length})[0],r=s.length*t+(s.length-1)*e.hspacing,a=o*t+(o-1)*e.vspacing;e.halign||(e.halign="left"),e.valign||(e.valign="bottom");var u=e.x,c=e.y,f=e.x+r,l=e.y+a;"center"==e.halign?(u=e.x-r/2,f=e.x+r/2):"right"==e.halign&&(u=e.x-r,f=e.x),"center"==e.valign?(c=e.y-a/2,l=e.y+a/2):"bottom"==e.valign&&(c=e.y-a,l=e.y);var h=u+r/2,d=c+a/2;if(e.render)for(var v=0;o>v;v++){var y=n[v],p=y.length*t+(y.length-1)*e.hspacing,g=e.x,w=e.y+(t+e.vspacing)*v;"center"==e.halign?g=e.x-p/2:"right"==e.halign&&(g=e.x-p),"center"==e.valign?w-=a/2:"bottom"==e.valign&&(w-=a),e.snap&&(g=Math.floor(g),w=Math.floor(w)),this.textLine({ctx:e.ctx,x:g,y:w,text:y,hspacing:e.hspacing||0,scale:e.scale||1,color:e.color})}return{sx:u,sy:c,cx:h,cy:d,ex:f,ey:l,width:r,height:a}}},g.gameover={step:function(e){Key.isDown(Key.r)&&(state="menu")},render:function(e){r(0,0,256,256,0),r(0,0,64,64,2),Txt.text({x:128,y:40+15*Math.sin(2.5*t),text:"GAME\nOVER",hspacing:8+4*Math.cos(2.9*t),vspacing:15+5*Math.sin(3.5*t),halign:"center",valign:"top",scale:10,snap:1,render:1,color:21})}},g.menu={step:function(e){Key.isDown(Key.p)&&(state="game")},render:function(e){r(0,0,256,256,0),r(0,0,64,64,2),Txt.text({x:128,y:40+15*Math.sin(2.5*t),text:"MENU",hspacing:8+4*Math.cos(2.9*t),vspacing:15+5*Math.sin(3.5*t),halign:"center",valign:"top",scale:10,snap:1,render:1,color:21})}},g.game={step(e){player.update(e),Key.justReleased(Key.z)&&(songTrigger=!0),songTrigger&&(playSound(sounds.song,1,1,0),songTrigger=!1),bulletPool.use(),Key.update()},render(t){A=0,e(1),player.draw()}},player={bullet:{x:0,y:0,xvel:0,yvel:0},init(){this.x=64,this.y=230,this.radius=12,this.xvel=0,this.yvel=0,this.xspeed=400,this.yspeed=400,this.drag=.6},update(e){this.bullet.x=player.x,this.bullet.y=player.y,this.xvel*=player.drag,this.yvel*=player.drag;let t=e*player.xvel,n=e*player.yvel;player.x+=t,player.y+=n,(Key.isDown(Key.d)||Key.isDown(Key.RIGHT))&&(player.xvel=player.xspeed),(Key.isDown(Key.a)||Key.isDown(Key.LEFT))&&(player.xvel=-player.xspeed),(Key.isDown(Key.w)||Key.isDown(Key.UP))&&(player.yvel=-player.yspeed),(Key.isDown(Key.s)||Key.isDown(Key.DOWN))&&(player.yvel=player.yspeed),Key.isDown(Key.SPACE||Key.isDown(Key.z))&&(player.bullet.yvel=-350,bulletPool.get(player.bullet)),player.x>256&&(player.x=0),0>player.x&&(player.x=256),player.y>256&&(player.y=0),0>player.y&&(state="gameover",player.y=256)},draw(e){s(this.x,this.y,this.radius,21)}},init=function(){last=0,dt=0,now=0,t=0,moveX=0,speedFactor=.6,songTrigger=!1,state="menu",bulletPool=new u(100,c),sounds={},starColors=[15,16,17,18,19,20,21],bulletPool.init(),player.init(),soundInit(),eventInit(),loop()},stopCapture=(e=>{}),loop=(()=>{let e=(new Date).getTime();dt=Math.min(1,(e-last)/1e3);t+=dt;g[state].render();g[state].step(dt);last=e;a();requestAnimationFrame(loop)}),soundInit=(()=>{sounds={};q&&q.close();window.AudioContext=window.AudioContext||window.webkitAudioContext;q||(q=new AudioContext);let e=new k.MusicGenerator(assets.song);e.createAudioBuffer(function(e){sounds.song=e})}),eventInit=(()=>{window.addEventListener("keyup",function(e){Key.onKeyup(e)},!1);window.addEventListener("mousedown",function(e){stopCapture(e)},!1);window.addEventListener("keydown",function(e){Key.onKeydown(e)},!1);window.addEventListener("blur",function(e){paused=!0},!1);window.addEventListener("focus",function(e){paused=!1},!1);window.addEventListener("resize",function(e){w.width=window.innerWidth,w.height=window.innerHeight})}),window.onload=init()}();
</script></body></html>